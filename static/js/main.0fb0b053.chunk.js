(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{104:function(e,t,n){},107:function(e,t,n){},109:function(e,t,n){"use strict";n.r(t);var a,r=n(0),o=n.n(r),l=n(64),c=n.n(l),i=(n(104),n(17)),u=n(3),s=n(11),d=n(25),f=n(13),m=f.b.div(a||(a=Object(s.a)(["\n  overflow: hidden;\n  width: 100%;\n  height: 100%;\n  position: absolute;\n  top: 0;\n  left: 0;\n  background: rgb(0, 0, 0, 0.5);\n  backdrop-filter: blur(5px);\n"])));var b,p,g,v,j,k,h,E,O,y,C,x,w,S,L,z,M,F,T,R=function(e){var t=Object(d.d)({appkey:"44189597732bee11ec3007f7d1464a90",libraries:["services","clusterer"],retries:3}),n=t.loading,a=t.error;return o.a.createElement(o.a.Fragment,null,n||a?o.a.createElement(m,null):o.a.createElement(d.b,e))},A=n(151),_=f.b.div(b||(b=Object(s.a)(["\n  position: absolute;\n  display: flex;\n  left: calc(0px + 50%);\n  translate: -50% 0%;\n  margin: 0 auto;\n  width: fit-content;\n  height: 42px;\n  place-items: center;\n  padding: 6px;\n  background: white;\n  border-radius: 8px;\n  box-shadow: rgba(0, 0, 0, 0.1) 0px 0px 1em;\n  box-sizing: border-box;\n\n  ","\n"])),function(e){return"top"==e.position?Object(f.a)(p||(p=Object(s.a)(["\n          top: 1rem;\n        "]))):Object(f.a)(g||(g=Object(s.a)(["\n          bottom: 1rem;\n        "])))}),B=f.b.div(v||(v=Object(s.a)(["\n  display: flex;\n  flex-direction: row;\n  gap: ",";\n  margin: 0px auto;\n  place-items: center;\n  box-sizing: border-box;\n"])),function(e){var t=e.gap;return"".concat(t,"rem")}),N=function(){return o.a.createElement(A.a,{orientation:"vertical"})},D=function(e){var t=e.position,n=e.gap,a=void 0===n?.5:n,r=e.style,l=void 0===r?{}:r,c=e.children;return o.a.createElement(_,{position:t,style:l},o.a.createElement(B,{gap:a},c))},I=n(156),P=n(2),U=n(10),J=Object(f.c)(j||(j=Object(s.a)(["\n  from {\n    transform: scale(1.0);\n    opacity: 1.0;\n  }\n  to {\n    transform: scale(2.0);\n    opacity: 0.0;\n  }\n"]))),W=f.b.div(k||(k=Object(s.a)(["\n  position: absolute;\n  display: flex;\n  width: 1em;\n  height: 1em;\n  background: ",";\n  border-radius: 8rem;\n  align-items: center;\n  justify-content: center;\n  scale: ",";\n\n  ",";\n\n  > .icon {\n    display: flex;\n    justify-content: center;\n    align-items: center;\n  }\n"])),function(e){return e.color},function(e){return e.size},function(e){return e.animate&&Object(f.a)(h||(h=Object(s.a)(["\n      animation: "," 1s ease-in-out infinite;\n    "])),J)}),V=f.b.div(E||(E=Object(s.a)(["\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  flex-direction: column;\n"]))),q=function(e){var t=e.color,n=void 0===t?"dodgerblue":t,a=e.size,r=void 0===a?2:a,l=e.children;return o.a.createElement(V,null,o.a.createElement(W,{color:n,size:r,animate:!0}),o.a.createElement(W,{color:n,size:r},o.a.createElement("div",{className:"icon"},l)))},Z=n(75),G=n.n(Z),X=n(71),$=n.n(X),H=f.b.div(O||(O=Object(s.a)(["\n  position: absolute;\n  top: 0;\n  left: 0;\n  width: 100%;\n  max-width: 280px;\n  height: 100%;\n  display: flex;\n  align-items: center;\n  justify-items: center;\n  transition: transform 400ms cubic-bezier(0.65, 0.05, 0.36, 1);\n  z-index: 99999;\n\n  ","\n"])),function(e){return e.fold&&Object(f.a)(y||(y=Object(s.a)(["\n      transform: translateX(-100%);\n    "])))}),K=f.b.div(C||(C=Object(s.a)(["\n  width: 100%;\n  height: 100%;\n  background-color: #ffffff;\n  border: 0;\n  border-radius: 0;\n  outline: 0;\n  margin: 0;\n  padding: 1em 2em;\n  box-sizing: border-box;\n  box-shadow: 0 0 1em rgba(128, 128, 128, 0.5);\n  overflow-y: auto;\n"]))),Q=f.b.div(x||(x=Object(s.a)(["\n  position: absolute;\n  display: flex;\n  width: 1.25em;\n  height: 100%;\n  right: -1.25em;\n  justify-content: center;\n  align-items: center;\n"]))),Y=f.b.div(w||(w=Object(s.a)(["\n  width: 100%;\n  height: 3em;\n  display: flex;\n  padding: 0 2px;\n  justify-content: center;\n  align-items: center;\n  box-sizing: border-box;\n  background-color: #ffffff;\n  border-top-right-radius: 5px;\n  border-bottom-right-radius: 5px;\n  clip-path: inset(-1em -1em -1em 0px);\n  box-shadow: 0 0 1em rgba(128, 128, 128, 0.5);\n  cursor: pointer;\n"]))),ee=function(e){var t=e._ref,n=e.children,a=Object(r.useState)(!0),l=Object(u.a)(a,2),c=l[0],i=l[1],s=Object(r.useCallback)(function(){var e={sx:{width:"100%",fontSize:"1rem"}};return c?o.a.createElement($.a,e):o.a.createElement(G.a,e)},[c]);return o.a.createElement(H,{fold:c},o.a.createElement(K,{ref:t},o.a.createElement(o.a.Fragment,null,n)),o.a.createElement(Q,null,o.a.createElement(Y,{onClick:function(e){i(function(e){return!e})}},o.a.createElement(s,null))))},te=o.a.forwardRef(function(e,t){return o.a.createElement(ee,{_ref:t},o.a.createElement(o.a.Fragment,null,e.children))}),ne=n(45),ae=n.n(ne),re=n(80),oe=n.n(re),le=n(81),ce=n.n(le),ie=n(155),ue=n(150),se={currentTime:null,logs:[]},de=Object(r.createContext)(void 0),fe=function(e){var t=Object(r.useState)(se),n=Object(u.a)(t,2),a=n[0],l=n[1];return o.a.createElement(de.Provider,{value:{state:Object(i.a)({},a),setState:l}},o.a.createElement(o.a.Fragment,null,e.children))},me=n(148),be=n(147),pe=n(149),ge=n(44),ve=n.n(ge),je=n(79),ke=n.n(je),he=n(78),Ee=n.n(he),Oe=n(153),ye=n(152),Ce=n(154),xe=function(e){var t=e.tooltip,n=void 0===t?void 0:t,a=e.tooltipColor,r=void 0===a?"primary":a,l=e.tooltipPlacement,c=void 0===l?"bottom":l,i=e.tooltipSize,u=void 0===i?"sm":i,s=e.active,d=e.disabled,f=void 0!==d&&d,m=e.loading,b=void 0!==m&&m,p=e.variant,g=void 0===p?"plain":p,v=e.size,j=e.onClick,k=e.children;return o.a.createElement(ye.a,{arrow:!0,title:n,color:r,placement:c,size:u,variant:g},o.a.createElement(Oe.a,{variant:s?"solid":"soft",sx:{"--IconButton-size":v},disabled:f,onClick:j},b?o.a.createElement(Ce.a,{color:"primary",size:"sm",value:33,variant:"plain"}):k))},we=n(77),Se=n.n(we),Le=function(e){var t=e.title,n=e.active,a=void 0!==n&&n,r=e.disabled,l=void 0!==r&&r,c=e.loading,i=void 0!==c&&c,u=e.icon,s=e.onClick;return o.a.createElement(xe,{tooltip:t,tooltipColor:"primary",tooltipPlacement:"top",active:a,disabled:l,loading:i,variant:"outlined",size:"32px",onClick:s},u)},ze=function(e){var t=e.speed,n=e.onSelectSpeed,a=o.a.useState(null),l=Object(u.a)(a,2),c=l[0],i=l[1],s=Boolean(c),d=function(){i(null)},f=Object(r.useCallback)(function(e){return o.a.createElement(me.a,Object.assign({},t===e&&{selected:!0,variant:"soft"},{onClick:function(){return function(e){n(e),d()}(e)}}),"x",e.toFixed(1))},[t]);return o.a.createElement("div",null,o.a.createElement(Le,{title:s?void 0:"\uc7ac\uc0dd \uc18d\ub3c4",onClick:function(e){i(e.currentTarget)},icon:o.a.createElement(Se.a,null)}),o.a.createElement(be.a,{anchorEl:c,open:s,onClose:d,color:"primary",size:"sm",variant:"plain"},f(1),f(2),f(5),f(10)))},Me=f.b.div(S||(S=Object(s.a)(["\n  width: calc(100vw - 600px);\n  width: calc(100svw - 600px);\n  max-width: 480px;\n  padding-left: 0.5rem;\n  padding-right: 1rem;\n  box-sizing: border-box;\n"]))),Fe=function(e){var t=e.running,n=e.runable,a=e.progressMax,l=e.progressCurrent,c=e.speed,i=e.onSelectSpeed,u=e.onProgressUpdated,s=e.onClickPlay,d=e.onClickUpload,f=Object(r.useCallback)(function(){return t?o.a.createElement(Le,{title:"\uc77c\uc2dc\uc815\uc9c0",onClick:s,icon:o.a.createElement(Ee.a,null)}):o.a.createElement(Le,{title:"\uc7ac\uc0dd",disabled:!n,onClick:s,icon:o.a.createElement(ke.a,null)})},[t,n]),m=Object(r.useCallback)(function(){var e=Object(r.useRef)(null);return o.a.createElement(o.a.Fragment,null,o.a.createElement("label",{htmlFor:"upload-log",style:{width:"32px"}},o.a.createElement("input",{ref:e,style:{display:"none"},id:"upload-log",name:"upload-log",type:"file",accept:".json,application/json",onChange:d}),o.a.createElement(Le,{title:"\uc5c5\ub85c\ub4dc",icon:o.a.createElement(ve.a,null),onClick:function(){e.current&&e.current.click()}})))},[d]);return o.a.createElement(o.a.Fragment,null,o.a.createElement(D,{position:"bottom"},o.a.createElement(m,null),o.a.createElement(f,null),o.a.createElement(ze,{speed:c,onSelectSpeed:i}),o.a.createElement(N,null),o.a.createElement(Me,null,o.a.createElement(pe.a,{color:"primary","aria-label":"Timestamp",defaultValue:0,value:l,min:0,max:a,step:1,disabled:!n||t,size:"md",valueLabelDisplay:"off",variant:"solid",onChange:function(e,t){console.log("new value",t),u("number"===typeof t?t:t[0])},style:{width:"calc(100% - 0.5rem)",marginLeft:"0.5rem"}}))))},Te=-1,Re=0,Ae=1,_e=2,Be=function(e){var t=e.color,n=e.style,a=e.children,r=e.onClick;return o.a.createElement("div",{style:Object(i.a)({backgroundColor:t||"black",display:"flex",justifyItems:"center",alignItems:"center",width:"32px",height:"32px",borderRadius:"6rem"},n),onClick:r||null},o.a.createElement(o.a.Fragment,null,a))},Ne=f.b.div(L||(L=Object(s.a)(["\n  width: calc(100% - 12px);\n  position: relative;\n  box-sizing: border-box;\n  padding: 0 6px;\n  display: flex;\n  align-items: center;\n"]))),De=f.b.div(z||(z=Object(s.a)(["\n  position: absolute;\n  width: 100%;\n  height: 3px;\n  background-color: #efefef;\n  border-radius: 1em;\n  z-index: 0;\n"]))),Ie=function(e){var t=e.type,n=e.style,a=void 0===n?{}:n,r=Object(i.a)({fill:"white",marginTop:"-1px",width:"75%"},a);return t==Te?o.a.createElement(o.a.Fragment,null):t==Re?o.a.createElement(ae.a,{style:r}):t==Ae?o.a.createElement(oe.a,{style:r}):t==_e?o.a.createElement(ce.a,{style:r}):void 0},Pe=f.b.div(M||(M=Object(s.a)(["\n  display: grid;\n  grid-template-columns: auto 1fr auto;\n  padding: 0.5rem 0;\n"]))),Ue=function(e,t,n,a,r,o){var l=Math.abs(n-e),c=Math.abs(a-t),i=r-e,u=o-t,s=Math.sqrt(i*i+u*u)/Math.sqrt(l*l+c*c);return Math.max(0,Math.min(100*s,100))},Je=function(){var e=Object(r.useState)([]),t=Object(u.a)(e,2),n=t[0],a=t[1],l=function(){var e=Object(r.useContext)(de);if(void 0===e)throw new Error("useStatusState should be used within StatusProvider");return[e.state,e.setState]}(),c=Object(u.a)(l,2),s=c[0],f=c[1],m=Object(r.useState)(3),b=Object(u.a)(m,2),p=b[0],g=b[1],v=Object(r.useState)(!1),j=Object(u.a)(v,2),k=j[0],h=j[1],E=Object(r.useState)(!1),O=Object(u.a)(E,2),y=O[0],C=O[1],x=Object(r.useState)(1),w=Object(u.a)(x,2),S=w[0],L=w[1],z=Object(r.useState)(0),M=Object(u.a)(z,2),F=M[0],T=M[1],R=Object(r.useState)(0),_=Object(u.a)(R,2),B=_[0],N=_[1],D=Object(r.useState)({}),I=Object(u.a)(D,2),J=I[0],W=I[1],V=Object(r.useState)([]),Z=Object(u.a)(V,2),G=Z[0],X=Z[1];Object(r.useEffect)(function(){var e=s.logs;h(e&&e.length>0),X(e),N(0)},[s]);var $=Object(d.e)();Object(r.useEffect)(function(){g($.getLevel())},[$]),Object(r.useEffect)(function(){$.setLevel(p)},[$,p]);var H=Object(r.useCallback)(function(e){if(G&&!(e>=G.length)){var t=G[e],n=(t.time,t.vehicles),r=t.tasks,o=Array.from(n||[]).map(function(e){var t=e.name,n=e.lat,a=e.lng;return{key:t,color:J[t],size:5,lat:n,lng:a,type:Re}}),l=Array.from(r||[]).map(function(e){var t=e.id,n=e.pick_lat,a=e.pick_lng,r=e.drop_lat,o=e.drop_lng,l=e.status;return[0<=l&&l<=5?{key:"task-".concat(t,"-pick"),color:J[t],size:4,lat:n,lng:a,type:Ae}:null,{key:"task-".concat(t,"-drop"),color:J[t],size:4,lat:r,lng:o,type:_e}]}).flat().filter(function(e){return null!==e});a([].concat(Object(U.a)(o),Object(U.a)(l)))}},[G,J]);Object(r.useEffect)(function(){H(B)},[B]),Object(r.useEffect)(function(){if(y){var e=1e3/(S||1);console.log("info",e,y,S);var t=setTimeout(function(){N(function(e){return e+1})},e);return function(){clearTimeout(t)}}},[y,S,B]);var K=Object(r.useCallback)(function(e){if(!(e.length<1)){var t=new kakao.maps.LatLngBounds;e.forEach(function(e){var n=e.lat,a=e.lng;t.extend(new kakao.maps.LatLng(n,a))}),$.setBounds(t)}},[$]);Object(r.useEffect)(function(){if(G&&!(G.length<1)){var e=G.map(function(e){var t,n=e.vehicles,a=e.tasks;return(t=n.map(function(e){return{lat:e.lat,lng:e.lng}})).concat.apply(t,Object(U.a)(a.map(function(e){return[{lat:e.pick_lat,lng:e.pick_lng},{lat:e.drop_lat,lng:e.drop_lng}]})))}).flat();T(G.length-1),K(e),H(0)}},[G,K,H]),Object(r.useEffect)(function(){if(G&&!(G.length<1)){var e=Object(U.a)(Array.from(new Set(G.map(function(e){var t=e.vehicles,n=e.tasks;return t.map(function(e){var t=e.name;return"".concat(t)}).concat(n.map(function(e){var t=e.id;return"".concat(t)}))}).flat()))).map(function(e){return Object(P.a)({},e,function(){var e=[255*Math.random(),255*Math.random(),255*Math.random()].map(Math.round);return e.filter(function(e){return e>=128}).length>2&&(e=e.map(function(e){return Math.max(0,2*(e-128))})),console.log(e,"#"+e.map(function(e){return e.toString(16).padStart(2,"0")}).join("")),"#"+e.map(function(e){return e.toString(16).padStart(2,"0")}).join("")}())}).reduce(function(e,t){return Object(i.a)({},e,t)},{});W(e)}},[G]);var Q=Object(r.useCallback)(function(e){var t=e.lat,n=e.lng;$.panTo(new kakao.maps.LatLng(t,n))},[$]),Y=Object(r.useCallback)(function(e){e.time;var t=e.vehicles,n=e.tasks,a=e.colors;return o.a.createElement(o.a.Fragment,null,t.filter(function(e){return null!=e.allocated_id}).sort(function(e,t){var n="".concat(e.lat,"-").concat(t.lat),a="".concat(e.lng,"-").concat(t.lng);return n<a?-1:n===a?0:1}).map(function(e){var t=e.name,r=e.lat,l=e.lng,c=e.allocated_id,u=Array.from(n||[]).filter(function(e){return e.id===c});if(u.length<1)return null;var s=u[0],d=s.id,f=s.status,m=s.pick_lat,b=s.pick_lng,p=s.drop_lat,g=s.drop_lng,v=f>5,j=f>6,k={backgroundColor:"transparent",borderWidth:"1px",borderColor:a[d],borderStyle:"dashed"},h={borderWidth:"1px",borderColor:"transparent",borderStyle:"solid"},E={fill:a[d]};return o.a.createElement(Pe,{className:"pairs",key:"log-info-".concat(d)},o.a.createElement(Be,{color:f<=5?"transparent":a[d],style:Object(i.a)({justifySelf:"flex-start",cursor:"pointer"},v?h:k),onClick:function(){Q({lat:m,lng:b})}},o.a.createElement(Ie,{type:Ae,style:Object(i.a)({margin:"0 auto"},v?{}:E)})),o.a.createElement(Ne,null,o.a.createElement(De,{style:v?{backgroundColor:a[d]}:{}}),o.a.createElement("div",{style:{position:"absolute",width:"calc(100% - 32px)",top:0}},o.a.createElement(Be,{key:"logicon-name",color:a[t],style:{position:"absolute",left:"".concat(Ue(m,b,p,g,r,l),"%"),transition:"all 300ms ease",cursor:"pointer",zIndex:1},onClick:function(){Q({lat:r,lng:l})}},o.a.createElement(Ie,{type:Re,style:{margin:"0 auto"}})))),o.a.createElement(Be,{color:a[d],style:Object(i.a)({justifySelf:"flex-end",cursor:"pointer"},j?h:k),onClick:function(){Q({lat:p,lng:g})}},o.a.createElement(Ie,{type:_e,style:Object(i.a)({margin:"0 auto"},j?{}:E)})))}))},[Q]),ee=Object(r.useState)([]),ne=Object(u.a)(ee,2),ae=ne[0],re=ne[1];Object(r.useEffect)(function(){if(G&&!(G.length<1)){var e=G.slice(0,B+1);re(e)}},[G,B]);var oe=Object(r.useCallback)(function(){if(!ae||ae.length<1)return o.a.createElement("center",{style:{position:"absolute",top:"50%",left:0,width:"100%"}},o.a.createElement(ie.a,{color:"neutral",fontSize:2,sx:{translate:"0% -50%",textAlign:"center"}},"\uc7ac\uc0dd\ud560 \uc815\ubcf4\uac00 \uc5c6\uc2b5\ub2c8\ub2e4."));var e=ae[ae.length-1],t=e.time,n=e.vehicles,a=e.tasks;return o.a.createElement(ue.a,{spacing:1},o.a.createElement("div",{key:"log-".concat(t)},o.a.createElement(A.a,{sx:{marginTop:"0.5rem",marginBottom:"0.25rem"}},o.a.createElement(ie.a,{color:"neutral",fontSize:2},function(e){var t={timeZone:"Asia/Seoul"},n=new Intl.DateTimeFormat("ko-kr",Object(i.a)({dateStyle:"full"},t)).format(e),a=new Intl.DateTimeFormat("ko-kr",Object(i.a)({dayPeriod:"long"},t)).format(e),r=new Intl.DateTimeFormat("ko-kr",Object(i.a)({hour:"numeric",minute:"numeric",second:"numeric",hour12:!0},t)).format(e).split(" ")[1].split(":"),o=Object(u.a)(r,3),l=o[0],c=o[1];return o[2],[n,a,"".concat(l,"\uc2dc ").concat(c,"\ubd84")].join("\n")}(new Date(t)))),o.a.createElement(Y,{time:t,vehicles:n,tasks:a,colors:J})))},[ae,J]);return o.a.createElement(o.a.Fragment,null,n.map(function(e){var t=e.key,n=e.color,a=e.size,r=e.lat,l=e.lng,c=e.type;return o.a.createElement(d.a,{key:t,position:{lat:r,lng:l},ref:function(e){null!=e&&(e.cc.parentElement.className="vehicle-marker")}},o.a.createElement(q,{color:n||"dodgerblue",size:a/p},o.a.createElement(Ie,{type:c})))}),o.a.createElement(Fe,{running:y,runable:k,progressMax:F,progressCurrent:B,speed:S,onSelectSpeed:L,onProgressUpdated:N,onClickPlay:function(){return C(!y)},onClickUpload:function(e){var t=e.target.files;if(t&&!(t.length<1)){var n=t[0],a=new FileReader;a.addEventListener("load",function(e){var t=e.target.result;try{var n=JSON.parse(t).logs;f(function(e){return Object(i.a)({},e,{logs:n})}),H(0)}catch(a){window.alert("Wrong JSON file format")}}),a.readAsText(n)}}}),o.a.createElement(te,null,o.a.createElement(oe,null)))},We=f.b.div(F||(F=Object(s.a)(["\n  position: absolute;\n  display: flex;\n  width: 0.75em;\n  height: 0.75em;\n  background: white;\n  border-width: 0.15rem;\n  border-style: solid;\n  border-color: ",";\n  border-radius: 8rem;\n  align-items: center;\n  justify-content: center;\n  scale: ",";\n  box-sizing: border-box;\n  cursor: pointer;\n\n  &:hover {\n    border-color: ",";\n  }\n"])),function(e){return e.selected?"black":"var(--joy-palette-danger-500, #d3232f)"},function(e){return e.size},function(e){return e.selected?"black":"var(--joy-palette-danger-600, #a10e25)"}),Ve=f.b.div(T||(T=Object(s.a)(["\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  flex-direction: column;\n"]))),qe=function(e){var t=e.id,n=e.size,a=void 0===n?2:n,r=e.selected,l=void 0!==r&&r,c=e.children,i=e.onMouseEnter,u=e.onMouseDown,s=e.onMouseLeave,d=e.onMouseUp,f=e.onClick;return o.a.createElement(Ve,{"data-id":t},o.a.createElement(We,{size:a,selected:l,onMouseEnter:i,onMouseLeave:s,onMouseDown:u,onMouseUp:d,onClick:f},o.a.createElement("div",{className:"icon"},c)))},Ze=n(82),Ge=n.n(Ze),Xe=n(83),$e=n.n(Xe),He=n(84),Ke=n.n(He),Qe=n(85),Ye=n.n(Qe),et=function(e){var t=e.title,n=e.active,a=void 0!==n&&n,r=e.icon,l=e.onClick;return o.a.createElement(xe,{tooltip:t,tooltipColor:"primary",tooltipPlacement:"top",active:a,variant:"outlined",size:"32px",onClick:l},r)},tt=function(e){var t=e.editMode,n=e.onModeChanged,a=e.onClickUpload,l=e.onClickDownload,c=function(e){n(e)},i=Object(r.useCallback)(function(){return o.a.createElement(o.a.Fragment,null,o.a.createElement(et,{title:"\uc810 \ucd94\uac00/\uc0ad\uc81c",active:"add"===t,icon:o.a.createElement(Ge.a,null),onClick:function(){return c("add")}}),o.a.createElement(et,{title:"\uc810 \uc5f0\uacb0",active:"link"===t,icon:o.a.createElement($e.a,null),onClick:function(){return c("link")}}),o.a.createElement(et,{title:"\uc810 \uc774\ub3d9",active:"move"===t,icon:o.a.createElement(Ke.a,null),onClick:function(){return c("move")}}))},[t]),u=Object(r.useCallback)(function(){var e=Object(r.useRef)(null);return o.a.createElement(o.a.Fragment,null,o.a.createElement("label",{htmlFor:"upload-log",style:{width:"100%"}},o.a.createElement("input",{ref:e,style:{display:"none"},id:"upload-log",name:"upload-log",type:"file",accept:".json,application/json",onChange:a}),o.a.createElement(et,{title:"\uc5c5\ub85c\ub4dc",icon:o.a.createElement(ve.a,null),onClick:function(){e.current&&e.current.click()}})))},[a]),s=Object(r.useCallback)(function(){return o.a.createElement(et,{title:"\ub2e4\uc6b4\ub85c\ub4dc",icon:o.a.createElement(Ye.a,null),onClick:l})},[l]);return o.a.createElement(o.a.Fragment,null,o.a.createElement(D,{position:"bottom"},o.a.createElement(i,null),o.a.createElement(N,null),o.a.createElement(u,null),o.a.createElement(s,null)))};function nt(e,t){var n="undefined"!==typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"===typeof e)return at(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return at(e,t)}(e))||t&&e&&"number"===typeof e.length){n&&(e=n);var a=0,r=function(){};return{s:r,n:function(){return a>=e.length?{done:!0}:{done:!1,value:e[a++]}},e:function(e){throw e},f:r}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,l=!0,c=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return l=e.done,e},e:function(e){c=!0,o=e},f:function(){try{l||null==n.return||n.return()}finally{if(c)throw o}}}}function at(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,a=new Array(t);n<t;n++)a[n]=e[n];return a}var rt=function(e,t){var n,a=e.map(function(e){return e.key}),r=function(e){return a.indexOf(e)},o={nodes:e.map(function(e){var t=e.key,n=e.lat,a=e.lng;return{id:r(t),lat:n,lng:a,info:{}}}),edges:t.map(function(e){var t=e.from,n=e.to;return{from:r(t),to:r(n)}})};!function(e,t){var n=document.createElement("a");n.download=e,n.href=URL.createObjectURL(t),n.dataset.downloadurl=["text/json",n.download,n.href].join(":"),n.addEventListener("click",function(e){setTimeout(function(){return URL.revokeObjectURL(n.href)},3e4)}),n.click()}("graph-"+(new Date).toISOString()+".json",(n=o,new Blob([JSON.stringify(n,null,2)],{type:"application/json"})))},ot=function(){var e=Object(d.e)(),t=Object(r.useState)([]),n=Object(u.a)(t,2),a=n[0],l=n[1],c=Object(r.useState)([]),s=Object(u.a)(c,2),f=s[0],m=s[1],b=Object(r.useState)([]),p=Object(u.a)(b,2),g=p[0],v=p[1],j=Object(r.useState)(1),k=Object(u.a)(j,2),h=(k[0],k[1]),E=Object(r.useState)("add"),O=Object(u.a)(E,2),y=O[0],C=O[1],x=Object(r.useState)([]),w=Object(u.a)(x,2),S=w[0],L=w[1],z=Object(r.useState)(),M=Object(u.a)(z,2),F=M[0],T=M[1],R=Object(r.useMemo)(function(){return g.filter(function(e){var t,n=e.from,a=e.to,r=nt(f);try{for(r.s();!(t=r.n()).done;){var o=t.value.key;if(n===o||a===o)return!0}}catch(l){r.e(l)}finally{r.f()}return!1})},[f,g]),A=Object(r.useCallback)(function(){var t=e.getBounds(),n=e.getLevel(),a=[t.getNorthEast(),t.getSouthWest()],r=a[0],o=a[1],l=o.getLat(),c=o.getLng(),i=r.getLat(),u=r.getLng();return{level:n,top:l,left:c,bottom:i,right:u,width:u-c,height:i-l}},[e]),_=Object(r.useCallback)(function(e){var t=A(),n=t.top,a=t.left,r=t.bottom,o=t.right,l=t.width,c=t.height,i=t.level,u=e.filter(function(e){var t=e.lat,l=e.lng;return n<=t&&t<=r&&a<=l&&l<=o}).map(function(e){var t=e.lat,n=e.lng;return{lat:t,lng:n,grid:"".concat(Math.round(t/(l/100)),",").concat(Math.round(n/(c/100)))}}),s=Object(U.a)(Array.from(new Map(u.map(function(e){var t=e.key;return[e.grid,{key:t,lat:e.lat,lng:e.lng}]})).values()));console.log("Bounds:",n,a,r,o),console.log("Nodes(Grid)",u,s),console.log("Bounds (width, height)",r-n,o-a,i),console.log("Set New Temporal Nodes",s),m(s)},[A]),B=Object(r.useCallback)(function(e){return-1!==S.indexOf(e)},[S]),N=Object(r.useMemo)(function(){var e=a.filter(function(e){var t=e.key;return B(t)});return e.length>0?e[0]:null},[a,B]),D=function(e,t){var n,a=nt(t);try{for(a.s();!(n=a.n()).done;){var r=n.value;if(r.key===e)return r}}catch(o){a.e(o)}finally{a.f()}return null},I=Object(r.useCallback)(function(e){return D(e,a)},[a]),P=Object(r.useCallback)(function(e){var t=null!==D(e,f);return console.log("isNodeVisible",e,t),t},[f]);Object(r.useEffect)(function(){h(e.getLevel()),setTimeout(function(){e.relayout()},0)},[e]),Object(r.useEffect)(function(){var e=function(e){return null!==I(e)};v(function(t){return t.filter(function(t){var n=t.from,a=t.to;return e(n)&&e(a)})})},[I,v]),Object(r.useEffect)(function(){if(console.log("selected",S),S.length>=2){var e=Object(u.a)(S,2),t=e[0],n=e[1],a=[I(t),I(n)],r=a[0],o=a[1];null!==r&&null!==o&&(function(e,t){v(function(n){return n.filter(function(n){return!(n.from==e.key&&n.to==t.key)}).concat({from:e.key,to:t.key})})}(r,o),T(void 0),L([]))}},[S,I,T]);var J=Object(r.useCallback)(function(e){var t=e.latLng;if("add"===y){var n=t.getLat(),a=t.getLng();console.log("Map Clicked",n,a),l(function(e){var t=Math.random().toString(16).slice(2),r={key:"node-".concat(t),lat:n,lng:a};return console.log("add node",r),[].concat(Object(U.a)(e),[r])})}},[y]),W=Object(r.useCallback)(function(e){},[]),V=Object(r.useCallback)(function(e){var t=e.latLng,n=t.getLat(),a=t.getLng();if("link"===y)T({key:"cursor",lat:n,lng:a});else if("move"===y){if(1!=S.length)return;l(function(e){return e.map(function(e){return S[0]!==e.key?e:Object(i.a)({},e,{lat:n,lng:a})})})}},[y,l,S,T]);Object(r.useEffect)(function(){var t=function(){return _(a)};return kakao.maps.event.addListener(e,"idle",t),function(){kakao.maps.event.addListener(e,"idle",t)}},[e,a]),Object(r.useEffect)(function(){_(a)},[a]),Object(r.useEffect)(function(){return e.setCursor("default"),kakao.maps.event.addListener(e,"click",J),kakao.maps.event.addListener(e,"mouseup",W),kakao.maps.event.addListener(e,"mousemove",V),function(){e.setCursor(""),kakao.maps.event.removeListener(e,"click",J),kakao.maps.event.removeListener(e,"mouseup",W),kakao.maps.event.removeListener(e,"mousemove",V)}},[e,J,W,V]);var q=Object(r.useCallback)(function(e){var t=e.target.closest("[data-id]");if(t){var n=t.getAttribute("data-id")||"",a=e.button;"add"===y?2===a&&l(function(e){return Object(U.a)(e).filter(function(e){return e.key!==n})}):"link"===y?0===a?L(function(e){return e.filter(function(e){return e!=n}).concat(n)}):2===a&&L(function(e){return e.filter(function(e){return e!=n})}):"move"===y&&0===a&&L(function(e){return e.length>0?[]:[n]})}},[y,l,L]),Z=Object(r.useCallback)(function(e){},[]),G=Object(r.useMemo)(function(){return o.a.createElement(o.a.Fragment,null,"link"===y&&N&&F&&o.a.createElement(d.c,{key:"edge-guide",path:[N,F].map(function(e){return{lat:e.lat,lng:e.lng}}),strokeWeight:3,strokeColor:"#db4040",strokeOpacity:1,strokeStyle:"dashed"}))},[y,N,F]),X=Object(r.useCallback)(function(){var e=A().level;return o.a.createElement(o.a.Fragment,null,f.map(function(t){var n=t.key,a=t.lat,r=t.lng;return o.a.createElement(d.a,{position:{lat:a,lng:r},key:n},o.a.createElement(qe,{id:n,size:6/e,selected:B(n),onMouseDown:q,onMouseUp:Z}))}))},[f,A,B,q,Z]),$=Object(r.useCallback)(function(){return o.a.createElement(o.a.Fragment,null,R.map(function(e){var t=e.from,n=e.to,a=[t,n].map(I).filter(function(e){return null!==e});return 2!=a.length?o.a.createElement(o.a.Fragment,null):o.a.createElement(d.c,{key:"edge-".concat(t,"-").concat(n),path:a.map(function(e){return{lat:e.lat,lng:e.lng}}),strokeWeight:3,strokeColor:"#db4040",strokeOpacity:1,strokeStyle:"solid"})}))},[R,I,P]),H=Object(r.useCallback)(function(t){if(!(t.length<1)){var n=new kakao.maps.LatLngBounds;t.forEach(function(e){var t=e.lat,a=e.lng;n.extend(new kakao.maps.LatLng(t,a))}),e.setBounds(n),setTimeout(function(){e.relayout()},0)}},[e]),K=Object(r.useCallback)(function(e){var t=e.target.files;if(t&&!(t.length<1)){var n=t[0],a=new FileReader;a.addEventListener("load",function(e){var t=e.target.result;try{var n=JSON.parse(t),a=n.nodes,r=n.edges,o=a.map(function(e){var t=e.id,n=e.lat,a=e.lng;return{key:"node-".concat(t),lat:n,lng:a}});l(o),v(r.map(function(e){var t=e.from,n=e.to;return{from:o[t].key,to:o[n].key}})),H(a)}catch(c){window.alert("Failed to parse JSON")}}),a.readAsText(n)}},[l,v]),Q=Object(r.useCallback)(function(){return rt(a,g)},[a,g]);return o.a.createElement(o.a.Fragment,null,o.a.createElement($,null),G,o.a.createElement(X,null),o.a.createElement(tt,{editMode:y||"add",onClickDownload:Q,onClickUpload:K,onModeChanged:C}))},lt=n(86),ct=n.n(lt),it={mode:"view",viewSpeed:1,viewRunning:!1},ut=Object(r.createContext)(void 0),st=function(e){var t=Object(r.useState)(it),n=Object(u.a)(t,2),a=n[0],l=n[1];return o.a.createElement(ut.Provider,{value:{state:Object(i.a)({},a),setState:l}},o.a.createElement(o.a.Fragment,null,e.children))},dt=function(){var e=Object(r.useContext)(ut);if(void 0===e)throw new Error("useControlState should be used within ControlProvider");return[e.state,e.setState]},ft=(n(107),function(e){var t=e.mode,n=e.onChange;return o.a.createElement(o.a.Fragment,null,o.a.createElement(I.a,{size:"sm",startDecorator:o.a.createElement(ae.a,null),variant:"view"===t?"solid":"plain",onClick:function(){return n("view")},sx:{borderTopRightRadius:0,borderBottomRightRadius:0}},"Viewer"),o.a.createElement(I.a,{size:"sm",startDecorator:o.a.createElement(ct.a,null),variant:"edit"===t?"solid":"plain",onClick:function(){return n("edit")},sx:{borderTopLeftRadius:0,borderBottomLeftRadius:0}},"Editor"))});function mt(){var e=dt(),t=Object(u.a)(e,2),n=t[0],a=t[1],l=Object(r.useState)(3),c=Object(u.a)(l,2),s=c[0],d=c[1],f=Object(r.useCallback)(function(){return o.a.createElement(D,{position:"top",gap:0,style:{padding:0,height:"auto"}},o.a.createElement(ft,{mode:n.mode,onChange:function(e){a(function(t){return Object(i.a)({},t,{mode:e})})}}))},[n.mode,a]);return o.a.createElement(o.a.Fragment,null,o.a.createElement(R,{center:{lat:37.52897,lng:126.917101},level:s,onZoomChanged:function(e){return d(e.getLevel())},style:{width:"100%",height:"100vh",zIndex:0}},o.a.createElement(f,null),"view"==n.mode?o.a.createElement(Je,null):o.a.createElement(ot,null)))}var bt=function(){return o.a.createElement("div",{className:"App"},o.a.createElement(fe,null,o.a.createElement(st,null,o.a.createElement(mt,null))))},pt=function(e){e&&e instanceof Function&&n.e(3).then(n.bind(null,158)).then(function(t){var n=t.getCLS,a=t.getFID,r=t.getFCP,o=t.getLCP,l=t.getTTFB;n(e),a(e),r(e),o(e),l(e)})};c.a.createRoot(document.getElementById("root")).render(o.a.createElement(bt,null)),pt()},97:function(e,t,n){e.exports=n(109)}},[[97,1,2]]]);
//# sourceMappingURL=main.0fb0b053.chunk.js.map