(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{112:function(e,t,n){e.exports=n(161)},119:function(e,t,n){},154:function(e,t,n){},159:function(e,t,n){},161:function(e,t,n){"use strict";n.r(t);var a,r=n(0),o=n.n(r),c=n(76),i=n.n(c),l=(n(119),n(20)),u=n(3),s=n(14),f=n(27),d=n(15),m=d.b.div(a||(a=Object(s.a)(["\n  overflow: hidden;\n  width: 100%;\n  height: 100%;\n  position: absolute;\n  top: 0;\n  left: 0;\n  background: rgb(0, 0, 0, 0.5);\n  backdrop-filter: blur(5px);\n"])));var b,p,g,v,h,y,j,O,k,E,w,x,C,V,S=function(e){var t=Object(f.d)({appkey:"44189597732bee11ec3007f7d1464a90",libraries:["services","clusterer"],retries:3}),n=t.loading,a=t.error;return o.a.createElement(o.a.Fragment,null,n||a?o.a.createElement(m,null):o.a.createElement(f.b,e))},L=n(205),M=d.b.div(b||(b=Object(s.a)(["\n  position: absolute;\n  display: flex;\n  left: calc(0px + 50%);\n  translate: -50% 0%;\n  margin: 0 auto;\n  width: fit-content;\n  height: 42px;\n  place-items: center;\n  padding: 6px;\n  background: white;\n  border-radius: 8px;\n  box-shadow: rgba(0, 0, 0, 0.1) 0px 0px 1em;\n  box-sizing: border-box;\n\n  ","\n"])),function(e){return"top"==e.position?Object(d.a)(p||(p=Object(s.a)(["\n          top: 1rem;\n        "]))):Object(d.a)(g||(g=Object(s.a)(["\n          bottom: 1rem;\n        "])))}),z=d.b.div(v||(v=Object(s.a)(["\n  display: flex;\n  flex-direction: row;\n  gap: ",";\n  margin: 0px auto;\n  place-items: center;\n  box-sizing: border-box;\n"])),function(e){var t=e.gap;return"".concat(t,"rem")}),F=function(){return o.a.createElement(L.a,{orientation:"vertical"})},T=function(e){var t=e.position,n=e.gap,a=void 0===n?.5:n,r=e.style,c=void 0===r?{}:r,i=e.children;return o.a.createElement(M,{position:t,style:c},o.a.createElement(z,{gap:a},i))},_=n(210),D=n(11),I=Object(d.c)(h||(h=Object(s.a)(["\n  from {\n    transform: scale(1.0);\n    opacity: 1.0;\n  }\n  to {\n    transform: scale(2.0);\n    opacity: 0.0;\n  }\n"]))),A=d.b.div(y||(y=Object(s.a)(["\n  position: absolute;\n  display: flex;\n  width: 1em;\n  height: 1em;\n  background: ",";\n  border-radius: 8rem;\n  align-items: center;\n  justify-content: center;\n  scale: ",";\n\n  ",";\n\n  > .icon {\n    display: flex;\n    justify-content: center;\n    align-items: center;\n  }\n"])),function(e){return e.color},function(e){return e.size},function(e){return e.animate&&Object(d.a)(j||(j=Object(s.a)(["\n      animation: "," 1s ease-in-out infinite;\n    "])),I)}),N=d.b.div(O||(O=Object(s.a)(["\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  flex-direction: column;\n"]))),P=function(e){var t=e.color,n=void 0===t?"dodgerblue":t,a=e.size,r=void 0===a?2:a,c=e.children;return o.a.createElement(N,null,o.a.createElement(A,{color:n,size:r,animate:!0}),o.a.createElement(A,{color:n,size:r},o.a.createElement("div",{className:"icon"},c)))},R=n(87),B=n.n(R),U=n(83),G=n.n(U),W=d.b.div(k||(k=Object(s.a)(["\n  position: absolute;\n  top: 0;\n  left: 0;\n  width: 100%;\n  max-width: 280px;\n  height: 100%;\n  display: flex;\n  align-items: center;\n  justify-items: center;\n  transition: transform 400ms cubic-bezier(0.65, 0.05, 0.36, 1);\n  z-index: 99999;\n\n  ","\n"])),function(e){return e.fold&&Object(d.a)(E||(E=Object(s.a)(["\n      transform: translateX(-100%);\n    "])))}),Y=d.b.div(w||(w=Object(s.a)(["\n  width: 100%;\n  height: 100%;\n  background-color: #ffffff;\n  border: 0;\n  border-radius: 0;\n  outline: 0;\n  margin: 0;\n  padding: 1em 2em;\n  box-sizing: border-box;\n  box-shadow: 0 0 1em rgba(128, 128, 128, 0.5);\n  overflow-y: auto;\n"]))),J=d.b.div(x||(x=Object(s.a)(["\n  position: absolute;\n  display: flex;\n  width: 1.25em;\n  height: 100%;\n  right: -1.25em;\n  justify-content: center;\n  align-items: center;\n"]))),q=d.b.div(C||(C=Object(s.a)(["\n  width: 100%;\n  height: 3em;\n  display: flex;\n  padding: 0 2px;\n  justify-content: center;\n  align-items: center;\n  box-sizing: border-box;\n  background-color: #ffffff;\n  border-top-right-radius: 5px;\n  border-bottom-right-radius: 5px;\n  clip-path: inset(-1em -1em -1em 0px);\n  box-shadow: 0 0 1em rgba(128, 128, 128, 0.5);\n  cursor: pointer;\n"]))),H=function(e){var t=e._ref,n=e.children,a=Object(r.useState)(!0),c=Object(u.a)(a,2),i=c[0],l=c[1],s=Object(r.useCallback)(function(){var e={sx:{width:"100%",fontSize:"1rem"}};return i?o.a.createElement(G.a,e):o.a.createElement(B.a,e)},[i]);return o.a.createElement(W,{fold:i},o.a.createElement(Y,{ref:t},o.a.createElement(o.a.Fragment,null,n)),o.a.createElement(J,null,o.a.createElement(q,{onClick:function(e){l(function(e){return!e})}},o.a.createElement(s,null))))},X=o.a.forwardRef(function(e,t){return o.a.createElement(H,{_ref:t},o.a.createElement(o.a.Fragment,null,e.children))}),Z=n(54),K=n.n(Z),$=n(95),Q=n.n($),ee=n(51),te=n.n(ee),ne=n(209),ae=n(204),re={currentTime:null,log:null},oe=Object(r.createContext)(void 0),ce=function(e){var t=Object(r.useState)(re),n=Object(u.a)(t,2),a=n[0],c=n[1];return o.a.createElement(oe.Provider,{value:{state:Object(l.a)({},a),setState:c}},o.a.createElement(o.a.Fragment,null,e.children))},ie=n(202),le=n(201),ue=n(203),se=n(91),fe=n.n(se),de=n(90),me=n.n(de),be=n(92),pe=n.n(be),ge=n(207),ve=n(206),he=n(208),ye=function(e){var t=e.tooltip,n=void 0===t?void 0:t,a=e.tooltipColor,r=void 0===a?"primary":a,c=e.tooltipPlacement,i=void 0===c?"bottom":c,l=e.tooltipSize,u=void 0===l?"sm":l,s=e.active,f=e.disabled,d=void 0!==f&&f,m=e.loading,b=void 0!==m&&m,p=e.variant,g=void 0===p?"plain":p,v=e.size,h=e.onClick,y=e.children;return o.a.createElement(ve.a,{arrow:!0,title:n,color:r,placement:i,size:u,variant:g},o.a.createElement(ge.a,{variant:s?"solid":"soft",sx:{"--IconButton-size":v},disabled:d,onClick:h},b?o.a.createElement(he.a,{color:"primary",size:"sm",value:33,variant:"plain"}):y))},je=n(89),Oe=n.n(je),ke=function(e){var t=e.title,n=e.active,a=void 0!==n&&n,r=e.disabled,c=void 0!==r&&r,i=e.loading,l=void 0!==i&&i,u=e.icon,s=e.onClick;return o.a.createElement(ye,{tooltip:t,tooltipColor:"primary",tooltipPlacement:"top",active:a,disabled:c,loading:l,variant:"outlined",size:"32px",onClick:s},u)},Ee=function(e){var t=e.speed,n=e.onSelectSpeed,a=o.a.useState(null),c=Object(u.a)(a,2),i=c[0],l=c[1],s=Boolean(i),f=function(){l(null)},d=Object(r.useCallback)(function(e){return o.a.createElement(ie.a,Object.assign({},t===e&&{selected:!0,variant:"soft"},{onClick:function(){return function(e){n(e),f()}(e)}}),"x",e.toFixed(1))},[t]);return o.a.createElement("div",null,o.a.createElement(ke,{title:s?void 0:"\uc7ac\uc0dd \uc18d\ub3c4",onClick:function(e){l(e.currentTarget)},icon:o.a.createElement(Oe.a,null)}),o.a.createElement(le.a,{anchorEl:i,open:s,onClose:f,color:"primary",size:"sm",variant:"plain"},d(1),d(2),d(5),d(10)))},we=d.b.div(V||(V=Object(s.a)(["\n  width: calc(100vw - 600px);\n  width: calc(100svw - 600px);\n  max-width: 480px;\n  padding-left: 0.5rem;\n  padding-right: 1rem;\n  box-sizing: border-box;\n"]))),xe=function(e){var t=e.running,n=e.runable,a=e.progressMax,c=e.progressCurrent,i=e.speed,l=e.expanded,u=e.onSelectSpeed,s=e.onProgressUpdated,f=e.onClickPlay,d=e.onClickExpand,m=Object(r.useCallback)(function(){return t?o.a.createElement(ke,{title:"\uc77c\uc2dc\uc815\uc9c0",onClick:f,icon:o.a.createElement(me.a,null)}):o.a.createElement(ke,{title:"\uc7ac\uc0dd",disabled:!n,onClick:f,icon:o.a.createElement(fe.a,null)})},[t,n]),b=Object(r.useCallback)(function(){return o.a.createElement(o.a.Fragment,null,o.a.createElement(ke,{title:l?"\ub2eb\uae30":"\uc790\uc138\ud788 \ubcf4\uae30",icon:l?o.a.createElement(te.a,null):o.a.createElement(pe.a,null),onClick:function(){d(!l)}}))},[l,d]);return o.a.createElement(o.a.Fragment,null,o.a.createElement(T,{position:"bottom"},o.a.createElement(m,null),o.a.createElement(Ee,{speed:i,onSelectSpeed:u}),o.a.createElement(F,null),o.a.createElement(we,null,o.a.createElement(ue.a,{color:"primary","aria-label":"Timestamp",defaultValue:0,value:c,min:0,max:a,step:1,disabled:!n||t,size:"md",valueLabelDisplay:"off",variant:"solid",onChange:function(e,t){console.log("new value",t),s("number"===typeof t?t:t[0])},style:{width:"calc(100% - 0.5rem)",marginLeft:"0.5rem"}})),o.a.createElement(F,null),o.a.createElement(b,null)))},Ce=n(93),Ve=n.n(Ce),Se=(n(153),n(154),n(94)),Le=n(200);function Me(){Me=function(){return e};var e={},t=Object.prototype,n=t.hasOwnProperty,a=Object.defineProperty||function(e,t,n){e[t]=n.value},r="function"==typeof Symbol?Symbol:{},o=r.iterator||"@@iterator",c=r.asyncIterator||"@@asyncIterator",i=r.toStringTag||"@@toStringTag";function l(e,t,n){return Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}),e[t]}try{l({},"")}catch(S){l=function(e,t,n){return e[t]=n}}function u(e,t,n,r){var o=t&&t.prototype instanceof d?t:d,c=Object.create(o.prototype),i=new x(r||[]);return a(c,"_invoke",{value:O(e,n,i)}),c}function s(e,t,n){try{return{type:"normal",arg:e.call(t,n)}}catch(S){return{type:"throw",arg:S}}}e.wrap=u;var f={};function d(){}function m(){}function b(){}var p={};l(p,o,function(){return this});var g=Object.getPrototypeOf,v=g&&g(g(C([])));v&&v!==t&&n.call(v,o)&&(p=v);var h=b.prototype=d.prototype=Object.create(p);function y(e){["next","throw","return"].forEach(function(t){l(e,t,function(e){return this._invoke(t,e)})})}function j(e,t){var r;a(this,"_invoke",{value:function(a,o){function c(){return new t(function(r,c){!function a(r,o,c,i){var l=s(e[r],e,o);if("throw"!==l.type){var u=l.arg,f=u.value;return f&&"object"==typeof f&&n.call(f,"__await")?t.resolve(f.__await).then(function(e){a("next",e,c,i)},function(e){a("throw",e,c,i)}):t.resolve(f).then(function(e){u.value=e,c(u)},function(e){return a("throw",e,c,i)})}i(l.arg)}(a,o,r,c)})}return r=r?r.then(c,c):c()}})}function O(e,t,n){var a="suspendedStart";return function(r,o){if("executing"===a)throw new Error("Generator is already running");if("completed"===a){if("throw"===r)throw o;return V()}for(n.method=r,n.arg=o;;){var c=n.delegate;if(c){var i=k(c,n);if(i){if(i===f)continue;return i}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if("suspendedStart"===a)throw a="completed",n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);a="executing";var l=s(e,t,n);if("normal"===l.type){if(a=n.done?"completed":"suspendedYield",l.arg===f)continue;return{value:l.arg,done:n.done}}"throw"===l.type&&(a="completed",n.method="throw",n.arg=l.arg)}}}function k(e,t){var n=t.method,a=e.iterator[n];if(void 0===a)return t.delegate=null,"throw"===n&&e.iterator.return&&(t.method="return",t.arg=void 0,k(e,t),"throw"===t.method)||"return"!==n&&(t.method="throw",t.arg=new TypeError("The iterator does not provide a '"+n+"' method")),f;var r=s(a,e.iterator,t.arg);if("throw"===r.type)return t.method="throw",t.arg=r.arg,t.delegate=null,f;var o=r.arg;return o?o.done?(t[e.resultName]=o.value,t.next=e.nextLoc,"return"!==t.method&&(t.method="next",t.arg=void 0),t.delegate=null,f):o:(t.method="throw",t.arg=new TypeError("iterator result is not an object"),t.delegate=null,f)}function E(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function w(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function x(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(E,this),this.reset(!0)}function C(e){if(e){var t=e[o];if(t)return t.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var a=-1,r=function t(){for(;++a<e.length;)if(n.call(e,a))return t.value=e[a],t.done=!1,t;return t.value=void 0,t.done=!0,t};return r.next=r}}return{next:V}}function V(){return{value:void 0,done:!0}}return m.prototype=b,a(h,"constructor",{value:b,configurable:!0}),a(b,"constructor",{value:m,configurable:!0}),m.displayName=l(b,i,"GeneratorFunction"),e.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===m||"GeneratorFunction"===(t.displayName||t.name))},e.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,b):(e.__proto__=b,l(e,i,"GeneratorFunction")),e.prototype=Object.create(h),e},e.awrap=function(e){return{__await:e}},y(j.prototype),l(j.prototype,c,function(){return this}),e.AsyncIterator=j,e.async=function(t,n,a,r,o){void 0===o&&(o=Promise);var c=new j(u(t,n,a,r),o);return e.isGeneratorFunction(n)?c:c.next().then(function(e){return e.done?e.value:c.next()})},y(h),l(h,i,"Generator"),l(h,o,function(){return this}),l(h,"toString",function(){return"[object Generator]"}),e.keys=function(e){var t=Object(e),n=[];for(var a in t)n.push(a);return n.reverse(),function e(){for(;n.length;){var a=n.pop();if(a in t)return e.value=a,e.done=!1,e}return e.done=!0,e}},e.values=C,x.prototype={constructor:x,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=void 0,this.done=!1,this.delegate=null,this.method="next",this.arg=void 0,this.tryEntries.forEach(w),!e)for(var t in this)"t"===t.charAt(0)&&n.call(this,t)&&!isNaN(+t.slice(1))&&(this[t]=void 0)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var t=this;function a(n,a){return c.type="throw",c.arg=e,t.next=n,a&&(t.method="next",t.arg=void 0),!!a}for(var r=this.tryEntries.length-1;r>=0;--r){var o=this.tryEntries[r],c=o.completion;if("root"===o.tryLoc)return a("end");if(o.tryLoc<=this.prev){var i=n.call(o,"catchLoc"),l=n.call(o,"finallyLoc");if(i&&l){if(this.prev<o.catchLoc)return a(o.catchLoc,!0);if(this.prev<o.finallyLoc)return a(o.finallyLoc)}else if(i){if(this.prev<o.catchLoc)return a(o.catchLoc,!0)}else{if(!l)throw new Error("try statement without catch or finally");if(this.prev<o.finallyLoc)return a(o.finallyLoc)}}}},abrupt:function(e,t){for(var a=this.tryEntries.length-1;a>=0;--a){var r=this.tryEntries[a];if(r.tryLoc<=this.prev&&n.call(r,"finallyLoc")&&this.prev<r.finallyLoc){var o=r;break}}o&&("break"===e||"continue"===e)&&o.tryLoc<=t&&t<=o.finallyLoc&&(o=null);var c=o?o.completion:{};return c.type=e,c.arg=t,o?(this.method="next",this.next=o.finallyLoc,f):this.complete(c)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),f},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.finallyLoc===e)return this.complete(n.completion,n.afterLoc),w(n),f}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.tryLoc===e){var a=n.completion;if("throw"===a.type){var r=a.arg;w(n)}return r}}throw new Error("illegal catch attempt")},delegateYield:function(e,t,n){return this.delegate={iterator:C(e),resultName:t,nextLoc:n},"next"===this.method&&(this.arg=void 0),f}},e}var ze,Fe,Te,_e,De,Ie,Ae,Ne,Pe,Re,Be=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,t=Object(r.useState)(),n=Object(u.a)(t,2),a=n[0],o=n[1],c=Object(r.useState)(e),i=Object(u.a)(c,2),l=i[0],s=i[1],f=Object(r.useState)(!1),d=Object(u.a)(f,2),m=d[0],b=d[1],p=Object(r.useState)(),g=Object(u.a)(p,2),v=g[0],h=g[1];Object(r.useEffect)(function(){a&&function(){var e=Object(Se.a)(Me().mark(function e(){var t;return Me().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return h(null),b(!0),e.prev=2,e.next=5,Object(Le.a)(a);case 5:t=e.sent,s(t.data),e.next=12;break;case 9:e.prev=9,e.t0=e.catch(2),h(e.t0);case 12:b(!1);case 13:case"end":return e.stop()}},e,null,[[2,9]])}));return function(){return e.apply(this,arguments)}}()()},[a]);return[{url:a,data:l,loading:m,error:v},function(e){return o(e)}]},Ue=((new Date).getTimezoneOffset(),{backgroundColor:"#dcdc33",color:"#1f1f1f",borderRadius:"4px",boxShadow:"1px 1px 0px rgba(0, 0, 0, 0.25)"}),Ge=function(e){return 0===e?{color:"white",backgroundColor:"gray",opacity:.5}:1===e?{color:"white",backgroundColor:"#0a6bde"}:2===e?{color:"white",backgroundColor:"#dcdc33"}:{}},We=function(e){var t=e.vehicle_id,n=e.schedules;return{id:"tracks-for-".concat(t),title:t,elements:n.map(function(e){e.load_time;var n=e.start_time,a=e.status,r=e.task_id,o=e.unload_time;return{id:"".concat(t,"-track-").concat(r),title:"#".concat(r),start:new Date(n),end:new Date(o),style:Object(l.a)({},Ue,Ge(a))}}),tracks:[]}},Ye=function(e,t){return new Date(e.getTime()+t)},Je=d.b.div(ze||(ze=Object(s.a)(["\n  position: relative;\n  display: flex;\n  justify-content: center;\n  align-items: center;\n  height: 100%;\n  color: #9f9f9f;\n"]))),qe=function(e){var t=e.time,n=Object(r.useState)(),a=Object(u.a)(n,2),c=a[0],i=a[1],l=Object(r.useState)({start:new Date,current:new Date,end:new Date}),s=Object(u.a)(l,2),f=s[0],d=s[1],m=Object(r.useState)(!1),b=Object(u.a)(m,2),p=b[0],g=b[1],v=Object(r.useState)(t.getFullYear()),h=Object(u.a)(v,2),y=h[0],j=h[1],O=Object(r.useState)(t.getMonth()+1),k=Object(u.a)(O,2),E=k[0],w=k[1],x=Object(r.useState)(t.getDay()),C=Object(u.a)(x,2),V=C[0],S=C[1],L=Object(r.useState)(t.getHours()),M=Object(u.a)(L,2),z=M[0],F=M[1],T=Object(r.useState)(t.getMinutes()),_=Object(u.a)(T,2),I=_[0],A=_[1],N=Object(r.useCallback)(function(e){var t=new Date(y,E-1,V),n=Ye(t,60*e*1e3);return t.toLocaleDateString()==n.toLocaleDateString()},[y,E,V]);Object(r.useEffect)(function(){console.log("Timeline time changed",t),j(t.getFullYear()),w(t.getMonth()+1),S(t.getDate()),F(t.getHours()),A(t.getMinutes())},[t]),Object(r.useEffect)(function(){g(!N(I))},[I]);var P=Be(),R=Object(u.a)(P,2),B=R[0],U=R[1];Object(r.useEffect)(function(){if(!p){console.log("Request schedule");var e="".concat("http://127.0.0.1:8000","/schedule/").concat(y,"/").concat(E,"/").concat(V,"/").concat(z,"/").concat(I,"?vehicles=").concat(10,"&tasks=").concat(130);U(e)}},[y,E,V,z,I,p]),Object(r.useEffect)(function(){B&&i(B.data)},[B]),Object(r.useEffect)(function(){if(console.log("snapshot",c),c&&c.time){var e=new Date(c.time);d({start:Ye(e,-108e5),current:e,end:Ye(e,324e5)}),g(!1)}else g(!0)},[c]);var G=Object(r.useMemo)(function(){var e=f.start,t=f.current,n=f.end,a=(n.getTime()-e.getTime())/6e5;return console.log("start",e),console.log("end",n),[{id:"minutes",title:t.toLocaleTimeString(),cells:Object(D.a)(Array(a)).map(function(n,a){var r=Ye(e,6e5*a),o=Ye(r,6e5),c=r.getMinutes();return{id:"header-m-".concat(r.getTime()),title:"",start:r,end:o,style:c==t.getMinutes()?{backgroundColor:"black"}:{}}}),useAsGrid:!0,style:{}}]},[f]),W=Object(r.useCallback)(function(){return c&&c.logs?o.a.createElement(Ve.a,{scale:{start:f.start,end:f.end,zoom:11},timebar:G,tracks:c.logs.map(We),now:f.current,enableSticky:!0}):o.a.createElement(Je,null,"No Data")},[c,G]);return o.a.createElement(W,null)},He=new Map([["V0","#f83cbd"],["V1","#7f209c"],["V2","#3d9630"],["V3","#1dfd57"],["V4","#0a748c"],["V5","#fc193f"],["V6","#188552"],["V7","#7129aa"],["V8","#713fbd"],["V9","#942122"],["V10","#652b94"],["V11","#a61109"],["V12","#32f53b"],["V13","#9f171a"],["V14","#43f02a"],["V15","#a52b5f"],["V16","#b03929"],["V17","#810c76"],["V18","#326f8d"],["V19","#1efd90"],["V20","#9f5c17"],["V21","#18921e"],["V22","#00f7aa"],["V23","#ac2905"],["V24","#837822"],["V25","#20812d"],["V26","#8b1a5e"],["V27","#b55c1d"],["V28","#2076b0"],["V29","#975a26"],["V30","#937213"],["V31","#842156"],["V32","#9c6d36"],["V33","#6cb822"],["V34","#25be30"],["V35","#3b9b41"],["V36","#02b65a"],["V37","#7eb13f"],["V38","#827409"],["V39","#403cbc"],["V40","#255481"],["V41","#70ae06"],["V42","#409f51"],["V43","#202aa9"],["V44","#33811d"],["V45","#0c8439"],["V46","#8b3407"],["V47","#b04060"],["V48","#4738ad"],["V49","#a9511a"],["V50","#438100"],["V51","#ba1f39"],["V52","#90237f"],["V53","#7315a0"],["V54","#03941c"],["V55","#32a647"],["V56","#b2742c"],["V57","#9f2f15"],["V58","#925218"],["V59","#1226b5"],["V60","#921b35"],["V61","#3a1a8e"],["V62","#23810e"],["V63","#572998"],["V64","#1c18bb"],["V65","#a06f1c"],["V66","#b01364"],["V67","#46ac02"],["V68","#ac2329"],["V69","#a26423"],["V70","#3f8b1a"],["V71","#8a5b2e"],["V72","#453c8f"],["V73","#98283a"],["V74","#b83314"],["V75","#313fab"],["V76","#3db578"],["V77","#1c3fbf"],["V78","#403580"],["V79","#2d619d"],["V80","#336c84"],["V81","#8c0f12"],["V82","#3e0ca6"],["V83","#66a62a"],["V84","#a62069"],["V85","#283dab"],["V86","#ae2779"],["V87","#8f0961"],["V88","#ab7737"],["V89","#b7171f"],["V90","#c00129"],["V91","#1b05a2"],["V92","#219514"],["V93","#2e9d51"],["V94","#7b2481"],["V95","#215b87"],["V96","#6e07a4"],["V97","#49ab04"],["V98","#10a772"],["V99","#ae2d52"]]),Xe=-1,Ze=0,Ke=1,$e=2,Qe=function(e){var t=e.color,n=e.style,a=e.children,c=e.tooltip,i=void 0===c?null:c,s=e.onClick,f=Object(r.useState)(!1),d=Object(u.a)(f,2),m=d[0],b=d[1];return o.a.createElement("div",{style:Object(l.a)({backgroundColor:t||"black",display:"flex",justifyItems:"center",alignItems:"center",width:"32px",height:"32px",borderRadius:"6rem"},n),onMouseOver:function(){return b(!0)},onMouseLeave:function(){return b(!1)},onClick:s||null},o.a.createElement(o.a.Fragment,null,a),o.a.createElement(o.a.Fragment,null,null!=i&&m&&i))},et=d.b.div(Fe||(Fe=Object(s.a)(["\n  width: calc(100% - 12px);\n  position: relative;\n  box-sizing: border-box;\n  padding: 0 6px;\n  display: flex;\n  align-items: center;\n"]))),tt=d.b.div(Te||(Te=Object(s.a)(["\n  position: absolute;\n  width: 100%;\n  height: 3px;\n  background-color: #efefef;\n  border-radius: 1em;\n  z-index: 0;\n"]))),nt=d.b.div(_e||(_e=Object(s.a)(["\n  position: absolute;\n  bottom: calc(-32px / 2 - -8px);\n  font-size: 12px;\n  left: calc(32px / 2);\n  width: fit-content;\n  white-space: nowrap;\n  word-break: keep-all;\n  background: ",";\n  color: white;\n  border-radius: 3px;\n  padding: 2px 6px;\n  box-sizing: border-box;\n  min-width: 32px;\n  transform: translateX(-50%);\n  text-align: center;\n  box-shadow: 0 0 3px rgba(128, 128, 128, 0.2);\n"])),function(e){return e.color}),at=function(e){var t=e.type,n=e.style,a=void 0===n?{}:n,r=Object(l.a)({fill:"white",marginTop:"-1px",width:"75%"},a);return t==Xe?o.a.createElement(o.a.Fragment,null):t==Ze?o.a.createElement(K.a,{style:r}):t==Ke?o.a.createElement(Q.a,{style:r}):t==$e?o.a.createElement(te.a,{style:r}):void 0},rt=d.b.div(De||(De=Object(s.a)(["\n  display: grid;\n  grid-template-columns: auto 1fr auto;\n  padding: 0.5rem 0;\n"]))),ot=function(e,t,n,a,r,o){var c=Math.abs(n-e),i=Math.abs(a-t),l=r-e,u=o-t,s=Math.sqrt(l*l+u*u)/Math.sqrt(c*c+i*i);return Math.max(0,Math.min(100*s,100))},ct=d.b.div(Ie||(Ie=Object(s.a)(["\n  position: fixed;\n  width: 100%;\n  bottom: 0;\n  left: 0;\n  background: white;\n  height: 300px;\n  transform: ",";\n  transition: transform 300ms ease-in-out;\n  box-shadow: 0 -3px 10px rgba(0, 0, 0, 0.2);\n"])),function(e){return e.expand?"translateY(0px)":"translateY(300px)"}),it=d.b.div(Ae||(Ae=Object(s.a)(["\n  position: relative;\n  width: 100%;\n"]))),lt=d.b.div(Ne||(Ne=Object(s.a)(["\n  position: absolute;\n  overflow: auto;\n  width: 100%;\n  height: 100%;\n  bottom: 0;\n"]))),ut=new Date("2020-08-29 06:00"),st=function(){var e=Object(r.useState)([]),t=Object(u.a)(e,2),n=t[0],a=t[1],c=function(){var e=Object(r.useContext)(oe);if(void 0===e)throw new Error("useStatusState should be used within StatusProvider");return[e.state,e.setState]}(),i=Object(u.a)(c,2),s=i[0],d=(i[1],Object(r.useState)(3)),m=Object(u.a)(d,2),b=m[0],p=m[1],g=Object(r.useState)(!1),v=Object(u.a)(g,2),h=v[0],y=v[1],j=Object(r.useState)(!1),O=Object(u.a)(j,2),k=O[0],E=O[1],w=Object(r.useState)(1),x=Object(u.a)(w,2),C=x[0],V=x[1],S=Object(r.useState)(0),M=Object(u.a)(S,2),z=M[0],F=(M[1],Object(r.useState)(0)),T=Object(u.a)(F,2),_=T[0],I=T[1],A=Object(r.useState)(0),N=Object(u.a)(A,2),R=N[0],B=N[1],U=Object(r.useState)(),G=Object(u.a)(U,2),W=G[0],Y=G[1],J=Object(r.useState)(new Map),q=Object(u.a)(J,2),H=q[0],Z=q[1],K=Be(),$=Object(u.a)(K,2),Q=$[0],ee=$[1],te=Object(r.useState)(ut),re=Object(u.a)(te,2),ce=re[0],ie=re[1];Object(r.useEffect)(function(){var e=new Date(ut.getTime()+60*R*1e3);console.log("elapsed",R),console.log("time",e),ie(e);var t,n={year:(t=e).getFullYear(),month:t.getMonth()+1,day:t.getDate(),hour:t.getHours(),minute:t.getMinutes(),second:t.getSeconds()},a=n.year,r=n.month,o=n.day,c=n.hour,i=n.minute,l="".concat("http://127.0.0.1:8000","/log/").concat(a,"/").concat(r,"/").concat(o,"/").concat(c,"/").concat(i,"?vehicles=").concat(10,"&tasks=").concat(130);ee(l)},[R]),Object(r.useEffect)(function(){var e=Q.data;Q.loading,Q.error,console.log("log fetched",e),Y(e)},[Q.data]),Object(r.useEffect)(function(){var e=s.log;y(null!==W),Y(e)},[s]);var le=Object(f.e)();Object(r.useEffect)(function(){p(le.getLevel())},[le]),Object(r.useEffect)(function(){le.setLevel(b)},[le,b]),Object(r.useEffect)(function(){if(W){W.time;var e=W.vehicles,t=W.tasks,n=Array.from(e||[]).map(function(e){var t=e.name,n=e.lat,a=e.lng;return{key:t,color:He.get(t)||"#cfcfcf",size:5,lat:n,lng:a,type:Ze}}),r=Array.from(t||[]).map(function(e){var t=e.id,n=e.pick_lat,a=e.pick_lng,r=e.drop_lat,o=e.drop_lng,c=e.status;return[0<=c&&c<=5?{key:"task-".concat(t,"-pick"),color:"#1d35ef66",size:4,lat:n,lng:a,type:Ke}:null,{key:"task-".concat(t,"-drop"),color:"#4d75ef66",size:4,lat:r,lng:o,type:$e}]}).flat().filter(function(e){return null!==e});console.log("markers[v]",n),console.log("markers[t]",r),a([].concat(Object(D.a)(n),Object(D.a)(r))),Z(function(t){for(var n=new Map(t),a=0,r=Array.from(e||[]);a<r.length;a++){var o=r[a],c=o.name;n.set(c,o)}return n})}},[W]),Object(r.useEffect)(function(){W&&Z(function(e){for(var t=Array.from(new Set(W.vehicles.map(function(e){return e.name||""}))),n=new Map(e),a=0,r=t;a<r.length;a++){var o=r[a];n.set(o,{name:o,lat:-1,lng:-1,allocated_id:null})}return n})},[W]),Object(r.useEffect)(function(){if(k){var e=1e3/(C||1);console.log("info",e,k,C);var t=setTimeout(function(){B(function(e){return e+5})},e);return function(){clearTimeout(t)}}},[k,C,R]);var ue=Object(r.useCallback)(function(e){if(!(e.length<1)){var t=new kakao.maps.LatLngBounds;e.forEach(function(e){var n=e.lat,a=e.lng;t.extend(new kakao.maps.LatLng(n,a))}),le.setBounds(t)}},[le]);Object(r.useEffect)(function(){ue([{lat:37.6299601,lng:126.8629739},{lat:37.4712457,lng:127.1006907}])},[]);var se=Object(r.useCallback)(function(e){var t=e.lat,n=e.lng;le.panTo(new kakao.maps.LatLng(t,n))},[le]),fe=function(e){var t=e.vehicle,n=e.tasks,a=t.name,r=t.lat,c=t.lng,i=(t.allocated_id,o.a.createElement(nt,{color:He.get(a)},a));if(n.length<1){var u={backgroundColor:"transparent",borderWidth:"1px",borderColor:"gray",borderStyle:"dashed"};return o.a.createElement(o.a.Fragment,null,o.a.createElement(rt,{className:"pairs",key:"log-info-".concat(a)},o.a.createElement(Qe,{color:"transparent",style:Object(l.a)({justifySelf:"flex-start"},u)}),o.a.createElement(et,null,o.a.createElement(tt,{style:{borderTop:"dashed 2px ".concat(He.get(a)),height:"auto",background:"transparent",borderRadius:0}}),o.a.createElement("div",{style:{position:"absolute",width:"calc(100% - 32px)",top:0}},o.a.createElement(Qe,{key:"logicon-".concat(a),color:He.get(a),style:{position:"absolute",left:"50%",transition:"all 300ms ease",zIndex:1,backgroundColor:"white",borderWidth:"1px",borderColor:He.get(a),borderStyle:"dashed"},tooltip:i},o.a.createElement(at,{type:Ze,style:{margin:"0 auto",fill:He.get(a)}})))),o.a.createElement(Qe,{color:"transparent",style:Object(l.a)({justifySelf:"flex-end"},u)})))}var s=n[0],f=(s.id,s.status),d=s.pick_lat,m=s.pick_lng,b=s.drop_lat,p=s.drop_lng,g=f>5,v=f>6,h={backgroundColor:"transparent",borderWidth:"1px",borderColor:He.get(a),borderStyle:"dashed"},y={borderWidth:"1px",borderColor:"transparent",borderStyle:"solid"},j={fill:He.get(a)};return o.a.createElement(rt,{className:"pairs",key:"log-info-".concat(a)},o.a.createElement(Qe,{color:f<=5?"transparent":He.get(a),style:Object(l.a)({justifySelf:"flex-start",cursor:"pointer"},g?y:h),onClick:function(){se({lat:d,lng:m})}},o.a.createElement(at,{type:Ke,style:Object(l.a)({margin:"0 auto"},g?{}:j)})),o.a.createElement(et,null,o.a.createElement(tt,{style:g?{backgroundColor:He.get(a)}:{}}),o.a.createElement("div",{style:{position:"absolute",width:"calc(100% - 32px)",top:0}},o.a.createElement(Qe,{key:"logicon-".concat(a),color:He.get(a),style:{position:"absolute",left:"".concat(ot(d,m,b,p,r,c),"%"),transition:"all 300ms ease",cursor:"pointer",zIndex:1},tooltip:i,onClick:function(){se({lat:r,lng:c})}},o.a.createElement(at,{type:Ze,style:{margin:"0 auto"}})))),o.a.createElement(Qe,{color:He.get(a),style:Object(l.a)({justifySelf:"flex-end",cursor:"pointer"},v?y:h),onClick:function(){se({lat:b,lng:p})}},o.a.createElement(at,{type:$e,style:Object(l.a)({margin:"0 auto"},v?{}:j)})))},de=Object(r.useCallback)(function(e){e.time;var t=e.vehicles,n=e.tasks;return o.a.createElement(o.a.Fragment,null,Array.from(t.values()).map(function(e){return e}).map(function(e){e.name,e.lat,e.lng;var t=e.allocated_id,a=Array.from(n||[]).filter(function(e){return e.id===t});return o.a.createElement(fe,{vehicle:e,tasks:a})}))},[se,H]),me=Object(r.useCallback)(function(){if(!W)return o.a.createElement("center",{style:{position:"absolute",top:"50%",left:0,width:"100%"}},o.a.createElement(ne.a,{color:"neutral",fontSize:2,sx:{translate:"0% -50%",textAlign:"center"}},"\uc7ac\uc0dd\ud560 \uc815\ubcf4\uac00 \uc5c6\uc2b5\ub2c8\ub2e4."));var e=W.time,t=W.tasks;return o.a.createElement(ae.a,{spacing:1},o.a.createElement("div",{key:"log-".concat(e)},o.a.createElement(L.a,{sx:{marginTop:"0.5rem",marginBottom:"0.25rem"}},o.a.createElement(ne.a,{color:"neutral",fontSize:2},function(){try{return function(e){var t={timeZone:"Asia/Seoul"},n=new Intl.DateTimeFormat("ko-kr",Object(l.a)({dateStyle:"full"},t)).format(e),a=new Intl.DateTimeFormat("ko-kr",Object(l.a)({dayPeriod:"long"},t)).format(e),r=new Intl.DateTimeFormat("ko-kr",Object(l.a)({hour:"numeric",minute:"numeric",second:"numeric",hour12:!0},t)).format(e).split(" ")[1].split(":"),o=Object(u.a)(r,3),c=o[0],i=o[1];return o[2],[n,a,"".concat(c,"\uc2dc ").concat(i,"\ubd84")].join("\n")}(new Date(e))}catch(t){return""}}())),o.a.createElement(de,{time:e,vehicles:H,tasks:t})))},[W,H]),be=Object(r.useState)(!1),pe=Object(u.a)(be,2),ge=pe[0],ve=pe[1];return o.a.createElement(o.a.Fragment,null,n.map(function(e){var t=e.key,n=e.color,a=e.size,r=e.lat,c=e.lng,i=e.type;return o.a.createElement(f.a,{key:"marker-".concat(t),position:{lat:r,lng:c},ref:function(e){null!=e&&(e.cc.parentElement.className="vehicle-marker")}},o.a.createElement(P,{color:n||"dodgerblue",size:a/b},o.a.createElement(at,{type:i})))}),o.a.createElement(ct,{expand:ge},o.a.createElement(it,null,o.a.createElement(xe,{running:k,runable:h,progressMax:z,progressCurrent:_,speed:C,expanded:ge,onSelectSpeed:V,onProgressUpdated:function(e){return I(5*R)},onClickPlay:function(){return E(!k)},onClickExpand:ve})),o.a.createElement(lt,null,o.a.createElement(qe,{time:ce}))),o.a.createElement(X,null,o.a.createElement(me,null)))},ft=d.b.div(Pe||(Pe=Object(s.a)(["\n  position: absolute;\n  display: flex;\n  width: 0.75em;\n  height: 0.75em;\n  background: white;\n  border-width: 0.15rem;\n  border-style: solid;\n  border-color: ",";\n  border-radius: 8rem;\n  align-items: center;\n  justify-content: center;\n  scale: ",";\n  box-sizing: border-box;\n  cursor: pointer;\n\n  &:hover {\n    border-color: ",";\n  }\n"])),function(e){var t=e.selected,n=e.color;return t?"black":void 0===n?"#d3232f":n},function(e){return e.size},function(e){var t=e.selected,n=e.color;return t?"black":void 0===n?"#a10e25":n}),dt=d.b.div(Re||(Re=Object(s.a)(["\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  flex-direction: column;\n"]))),mt=function(e){var t=e.id,n=e.size,a=void 0===n?2:n,r=e.selected,c=void 0!==r&&r,i=e.color,l=e.children,u=e.onMouseEnter,s=e.onMouseDown,f=e.onMouseLeave,d=e.onMouseUp,m=e.onClick;return o.a.createElement(dt,{"data-id":t},o.a.createElement(ft,{size:a,color:i,selected:c,onMouseEnter:u,onMouseLeave:f,onMouseDown:s,onMouseUp:d,onClick:m},o.a.createElement("div",{className:"icon"},l)))},bt=n(96),pt=n.n(bt),gt=n(97),vt=n.n(gt),ht=n(98),yt=n.n(ht),jt=n(99),Ot=n.n(jt),kt=n(100),Et=n.n(kt),wt=function(e){var t=e.title,n=e.active,a=void 0!==n&&n,r=e.icon,c=e.onClick;return o.a.createElement(ye,{tooltip:t,tooltipColor:"primary",tooltipPlacement:"top",active:a,variant:"outlined",size:"32px",onClick:c},r)},xt=function(e){var t=e.editMode,n=e.onModeChanged,a=e.onClickUpload,c=e.onClickDownload,i=function(e){n(e)},l=Object(r.useCallback)(function(){return o.a.createElement(o.a.Fragment,null,o.a.createElement(wt,{title:"\uc810 \ucd94\uac00/\uc0ad\uc81c",active:"add"===t,icon:o.a.createElement(pt.a,null),onClick:function(){return i("add")}}),o.a.createElement(wt,{title:"\uc810 \uc5f0\uacb0",active:"link"===t,icon:o.a.createElement(vt.a,null),onClick:function(){return i("link")}}),o.a.createElement(wt,{title:"\uc810 \uc774\ub3d9",active:"move"===t,icon:o.a.createElement(yt.a,null),onClick:function(){return i("move")}}))},[t]),u=Object(r.useCallback)(function(){var e=Object(r.useRef)(null);return o.a.createElement(o.a.Fragment,null,o.a.createElement("label",{htmlFor:"upload-log",style:{width:"100%"}},o.a.createElement("input",{ref:e,style:{display:"none"},id:"upload-log",name:"upload-log",type:"file",accept:".json,application/json",onChange:a}),o.a.createElement(wt,{title:"\uc5c5\ub85c\ub4dc",icon:o.a.createElement(Ot.a,null),onClick:function(){e.current&&e.current.click()}})))},[a]),s=Object(r.useCallback)(function(){return o.a.createElement(wt,{title:"\ub2e4\uc6b4\ub85c\ub4dc",icon:o.a.createElement(Et.a,null),onClick:c})},[c]);return o.a.createElement(o.a.Fragment,null,o.a.createElement(T,{position:"bottom"},o.a.createElement(l,null),o.a.createElement(F,null),o.a.createElement(u,null),o.a.createElement(s,null)))};function Ct(e){return"#"+e.map(function(e){return e.toString(16).padStart(2,"0")}).join("")}function Vt(e){for(var t=Object(D.a)(e),n=t.length-1;n>0;n--){var a=Math.floor(Math.random()*(n+1)),r=t[n];t[n]=t[a],t[a]=r}return t}var St=n(28),Lt=n(29),Mt=function(){function e(t){Object(St.a)(this,e),this.nodes=void 0,this.parentIdx=void 0,this.nodes=t,this.parentIdx=new Map}return Object(Lt.a)(e,[{key:"hasKey",value:function(e){return e in this.parentIdx}},{key:"find",value:function(e){var t=this.parentIdx.get(e);if(t&&e!==t){var n=this.find(t);return this.parentIdx.set(e,n),n}return this.parentIdx.set(e,e),e}},{key:"merge",value:function(e,t){var n=this.find(e),a=this.find(t);this.parentIdx.set(n,a)}},{key:"keys",value:function(){return Array.from(this.parentIdx.keys())}}]),e}();function zt(e,t){var n="undefined"!==typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"===typeof e)return Ft(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return Ft(e,t)}(e))||t&&e&&"number"===typeof e.length){n&&(e=n);var a=0,r=function(){};return{s:r,n:function(){return a>=e.length?{done:!0}:{done:!1,value:e[a++]}},e:function(e){throw e},f:r}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,c=!0,i=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return c=e.done,e},e:function(e){i=!0,o=e},f:function(){try{c||null==n.return||n.return()}finally{if(i)throw o}}}}function Ft(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,a=new Array(t);n<t;n++)a[n]=e[n];return a}var Tt=function(e,t){var n,a=e.map(function(e){return e.key}),r=function(e){return a.indexOf(e)},o={nodes:e.map(function(e){var t=e.key,n=e.lat,a=e.lng;return{id:r(t),lat:n,lng:a,info:{}}}),edges:t.map(function(e){var t=e.from,n=e.to;return{from:r(t),to:r(n)}})};!function(e,t){var n=document.createElement("a");n.download=e,n.href=URL.createObjectURL(t),n.dataset.downloadurl=["text/json",n.download,n.href].join(":"),n.addEventListener("click",function(e){setTimeout(function(){return URL.revokeObjectURL(n.href)},3e4)}),n.click()}("graph-"+(new Date).toISOString()+".json",(n=o,new Blob([JSON.stringify(n,null,2)],{type:"application/json"})))},_t=function(){var e=Object(f.e)(),t=Object(r.useState)([]),n=Object(u.a)(t,2),a=n[0],c=n[1],i=Object(r.useState)([]),s=Object(u.a)(i,2),d=s[0],m=s[1],b=Object(r.useState)([]),p=Object(u.a)(b,2),g=p[0],v=p[1],h=Object(r.useState)(1),y=Object(u.a)(h,2),j=(y[0],y[1]),O=Object(r.useState)("add"),k=Object(u.a)(O,2),E=k[0],w=k[1],x=Object(r.useState)([]),C=Object(u.a)(x,2),V=C[0],S=C[1],L=Object(r.useState)(),M=Object(u.a)(L,2),z=M[0],F=M[1],T=Object(r.useState)([]),_=Object(u.a)(T,2),I=_[0],A=_[1],N=Object(r.useState)(new Map),P=Object(u.a)(N,2),R=P[0],B=P[1],U=Object(r.useMemo)(function(){return console.log("_visibleEdges",I),I.map(function(e){return e.from,e.to,e})},[I]);Object(r.useEffect)(function(){var e=g.filter(function(e){var t,n=e.from,a=e.to,r=zt(d);try{for(r.s();!(t=r.n()).done;){var o=t.value.key;if(n===o||a===o)return!0}}catch(c){r.e(c)}finally{r.f()}return!1});A(e)},[d,g]),Object(r.useEffect)(function(){var e,t=new Mt(a),n=zt(g);try{for(n.s();!(e=n.n()).done;){var r=e.value;t.merge(r.from,r.to)}}catch(h){n.e(h)}finally{n.f()}var o,c=new Map,i=new Map,l=zt(t.keys());try{for(l.s();!(o=l.n()).done;){var u=o.value;i.set(u,Ct(Vt([64*Math.random(),128*Math.random(),64*Math.random()+128].map(Math.round))))}}catch(h){l.e(h)}finally{l.f()}var s,f=zt(g);try{for(f.s();!(s=f.n()).done;){var d=s.value,m=d.from,b=d.to,p=t.find(m),v=t.find(b);c.set(m,i.get(p)),c.set(b,i.get(v))}}catch(h){f.e(h)}finally{f.f()}console.log("set graph colors",c),B(c)},[a,g]);var G=Object(r.useCallback)(function(){var t=e.getBounds(),n=e.getLevel(),a=[t.getNorthEast(),t.getSouthWest()],r=a[0],o=a[1],c=o.getLat(),i=o.getLng(),l=r.getLat(),u=r.getLng();return{level:n,top:c,left:i,bottom:l,right:u,width:u-i,height:l-c}},[e]),W=Object(r.useCallback)(function(e){var t=G(),n=t.top,a=t.left,r=t.bottom,o=t.right,c=t.width,i=t.height,l=t.level,u=e.filter(function(e){var t=e.lat,c=e.lng;return n<=t&&t<=r&&a<=c&&c<=o}).map(function(e){var t=e.key,n=e.lat,a=e.lng;return{id:t,key:t,lat:n,lng:a,grid:"".concat(Math.round(n/(c/100)),",").concat(Math.round(a/(i/100)))}}),s=Object(D.a)(Array.from(new Map(u.map(function(e){var t=e.key;return[e.grid,{id:t,key:t,lat:e.lat,lng:e.lng}]})).values()));console.log("Bounds:",n,a,r,o),console.log("Nodes(Grid)",u,s),console.log("Bounds (width, height)",r-n,o-a,l),console.log("Set New Temporal Nodes",s),m(s)},[G]),Y=Object(r.useCallback)(function(e){return-1!==V.indexOf(e)},[V]),J=Object(r.useMemo)(function(){var e=a.filter(function(e){var t=e.key;return Y(t)});return e.length>0?e[0]:null},[a,Y]),q=function(e,t){var n,a=zt(t);try{for(a.s();!(n=a.n()).done;){var r=n.value;if(r.key===e)return r}}catch(o){a.e(o)}finally{a.f()}return null},H=Object(r.useCallback)(function(e){return q(e,a)},[a]),X=Object(r.useCallback)(function(e){var t=null!==q(e,d);return console.log("isNodeVisible",e,t),t},[d]);Object(r.useEffect)(function(){j(e.getLevel()),setTimeout(function(){e.relayout()},0)},[e]),Object(r.useEffect)(function(){var e=function(e){return null!==H(e)};v(function(t){return t.filter(function(t){var n=t.from,a=t.to;return e(n)&&e(a)})})},[H,v]),Object(r.useEffect)(function(){if(console.log("selected",V),V.length>=2){var e=Object(u.a)(V,2),t=e[0],n=e[1],a=[H(t),H(n)],r=a[0],o=a[1];null!==r&&null!==o&&(function(e,t){v(function(n){return n.filter(function(n){return!(n.from==e.key&&n.to==t.key)}).concat({from:e.key,to:t.key})})}(r,o),F(void 0),S([]))}},[V,H,F]);var Z=Object(r.useCallback)(function(e){var t=e.latLng;if("add"===E){var n=t.getLat(),a=t.getLng();console.log("Map Clicked",n,a),c(function(e){var t=Math.random().toString(16).slice(2),r={key:"node-".concat(t),lat:n,lng:a};return console.log("add node",r),[].concat(Object(D.a)(e),[r])})}},[E]),K=Object(r.useCallback)(function(e){},[]),$=Object(r.useCallback)(function(e){var t=e.latLng,n=t.getLat(),a=t.getLng();if("link"===E)F({key:"cursor",lat:n,lng:a});else if("move"===E){if(1!=V.length)return;c(function(e){return e.map(function(e){return V[0]!==e.key?e:Object(l.a)({},e,{lat:n,lng:a})})})}},[E,c,V,F]);Object(r.useEffect)(function(){var t=function(){return W(a)};return kakao.maps.event.addListener(e,"idle",t),function(){kakao.maps.event.addListener(e,"idle",t)}},[e,a]),Object(r.useEffect)(function(){W(a)},[a]),Object(r.useEffect)(function(){return e.setCursor("default"),kakao.maps.event.addListener(e,"click",Z),kakao.maps.event.addListener(e,"mouseup",K),kakao.maps.event.addListener(e,"mousemove",$),function(){e.setCursor(""),kakao.maps.event.removeListener(e,"click",Z),kakao.maps.event.removeListener(e,"mouseup",K),kakao.maps.event.removeListener(e,"mousemove",$)}},[e,Z,K,$]);var Q=Object(r.useCallback)(function(e){var t=e.target.closest("[data-id]");if(t){var n=t.getAttribute("data-id")||"",a=e.button;"add"===E?2===a&&c(function(e){return Object(D.a)(e).filter(function(e){return e.key!==n})}):"link"===E?0===a?S(function(e){return e.filter(function(e){return e!=n}).concat(n)}):2===a&&S(function(e){return e.filter(function(e){return e!=n})}):"move"===E&&0===a&&S(function(e){return e.length>0?[]:[n]})}},[E,c,S]),ee=Object(r.useCallback)(function(e){},[]),te=Object(r.useMemo)(function(){return o.a.createElement(o.a.Fragment,null,"link"===E&&J&&z&&o.a.createElement(f.c,{key:"edge-guide",path:[J,z].map(function(e){return{lat:e.lat,lng:e.lng}}),strokeWeight:3,strokeColor:"#db4040",strokeOpacity:1,strokeStyle:"dashed"}))},[E,J,z]),ne=Object(r.useCallback)(function(){var e=G().level;return o.a.createElement(o.a.Fragment,null,d.map(function(t){var n=t.key,a=t.lat,r=t.lng;return o.a.createElement(f.a,{position:{lat:a,lng:r},key:n},o.a.createElement(mt,{id:n,color:R.get(n),size:6/e,selected:Y(n),onMouseDown:Q,onMouseUp:ee}))}))},[d,R,G,Y,Q,ee]),ae=Object(r.useCallback)(function(){return console.log("graph colors",R),o.a.createElement(o.a.Fragment,null,U.map(function(e){var t=e.from,n=e.to,a=[t,n].map(H).filter(function(e){return null!==e});return 2!=a.length?o.a.createElement(o.a.Fragment,null):o.a.createElement(f.c,{key:"edge-".concat(t,"-").concat(n),path:a.map(function(e){return{lat:e.lat,lng:e.lng}}),strokeWeight:3,strokeColor:R.get(t),strokeOpacity:1,strokeStyle:"solid"})}))},[U,R,H,X]),re=Object(r.useCallback)(function(t){if(!(t.length<1)){var n=new kakao.maps.LatLngBounds;t.forEach(function(e){var t=e.lat,a=e.lng;n.extend(new kakao.maps.LatLng(t,a))}),e.setBounds(n),setTimeout(function(){e.relayout()},0)}},[e]),oe=Object(r.useCallback)(function(e){var t=e.target.files;if(t&&!(t.length<1)){var n=t[0],a=new FileReader;a.addEventListener("load",function(e){var t=e.target.result;try{var n=JSON.parse(t),a=n.nodes,r=n.edges,o=a.map(function(e){var t=e.id,n=e.lat,a=e.lng;return{key:"node-".concat(t),lat:n,lng:a}});c(o),v(r.map(function(e){var t=e.from,n=e.to;return{from:o[t].key,to:o[n].key}})),re(a)}catch(i){window.alert("Failed to parse JSON")}}),a.readAsText(n)}},[c,v]),ce=Object(r.useCallback)(function(){return Tt(a,g)},[a,g]);return o.a.createElement(o.a.Fragment,null,o.a.createElement(ae,null),te,o.a.createElement(ne,null),o.a.createElement(xt,{editMode:E||"add",onClickDownload:ce,onClickUpload:oe,onModeChanged:w}))},Dt=n(101),It=n.n(Dt),At={mode:"view",viewSpeed:1,viewRunning:!1},Nt=Object(r.createContext)(void 0),Pt=function(e){var t=Object(r.useState)(At),n=Object(u.a)(t,2),a=n[0],c=n[1];return o.a.createElement(Nt.Provider,{value:{state:Object(l.a)({},a),setState:c}},o.a.createElement(o.a.Fragment,null,e.children))},Rt=function(){var e=Object(r.useContext)(Nt);if(void 0===e)throw new Error("useControlState should be used within ControlProvider");return[e.state,e.setState]},Bt=(n(159),function(e){var t=e.mode,n=e.onChange;return o.a.createElement(o.a.Fragment,null,o.a.createElement(_.a,{size:"sm",startDecorator:o.a.createElement(K.a,null),variant:"view"===t?"solid":"plain",onClick:function(){return n("view")},sx:{borderTopRightRadius:0,borderBottomRightRadius:0}},"Viewer"),o.a.createElement(_.a,{size:"sm",startDecorator:o.a.createElement(It.a,null),variant:"edit"===t?"solid":"plain",onClick:function(){return n("edit")},sx:{borderTopLeftRadius:0,borderBottomLeftRadius:0}},"Editor"))});function Ut(){var e=Rt(),t=Object(u.a)(e,2),n=t[0],a=t[1],c=Object(r.useState)(3),i=Object(u.a)(c,2),s=i[0],f=i[1],d=Object(r.useCallback)(function(){return o.a.createElement(T,{position:"top",gap:0,style:{padding:0,height:"auto"}},o.a.createElement(Bt,{mode:n.mode,onChange:function(e){a(function(t){return Object(l.a)({},t,{mode:e})})}}))},[n.mode,a]);return o.a.createElement(o.a.Fragment,null,o.a.createElement(S,{center:{lat:37.52897,lng:126.917101},level:s,onZoomChanged:function(e){return f(e.getLevel())},style:{width:"100%",height:"100vh",zIndex:0}},o.a.createElement(d,null),"view"==n.mode?o.a.createElement(st,null):o.a.createElement(_t,null)))}var Gt=function(){return o.a.createElement("div",{className:"App"},o.a.createElement(ce,null,o.a.createElement(Pt,null,o.a.createElement(Ut,null))))},Wt=function(e){e&&e instanceof Function&&n.e(3).then(n.bind(null,212)).then(function(t){var n=t.getCLS,a=t.getFID,r=t.getFCP,o=t.getLCP,c=t.getTTFB;n(e),a(e),r(e),o(e),c(e)})};i.a.createRoot(document.getElementById("root")).render(o.a.createElement(Gt,null)),Wt()}},[[112,1,2]]]);
//# sourceMappingURL=main.cb8085b4.chunk.js.map