(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{106:function(e,t,n){},109:function(e,t,n){},111:function(e,t,n){"use strict";n.r(t);var a,r=n(0),o=n.n(r),l=n(64),c=n.n(l),i=(n(106),n(17)),u=n(3),s=n(11),d=n(25),f=n(13),m=f.b.div(a||(a=Object(s.a)(["\n  overflow: hidden;\n  width: 100%;\n  height: 100%;\n  position: absolute;\n  top: 0;\n  left: 0;\n  background: rgb(0, 0, 0, 0.5);\n  backdrop-filter: blur(5px);\n"])));var b,p,g,v,h,k,j,O,E,y,x,w,C,S,L,M,z,F=function(e){var t=Object(d.d)({appkey:"44189597732bee11ec3007f7d1464a90",libraries:["services","clusterer"],retries:3}),n=t.loading,a=t.error;return o.a.createElement(o.a.Fragment,null,n||a?o.a.createElement(m,null):o.a.createElement(d.b,e))},I=n(153),T=f.b.div(b||(b=Object(s.a)(["\n  position: absolute;\n  display: flex;\n  left: calc(0px + 50%);\n  translate: -50% 0%;\n  margin: 0 auto;\n  width: fit-content;\n  height: 42px;\n  place-items: center;\n  padding: 6px;\n  background: white;\n  border-radius: 8px;\n  box-shadow: rgba(0, 0, 0, 0.1) 0px 0px 1em;\n  box-sizing: border-box;\n\n  ","\n"])),function(e){return"top"==e.position?Object(f.a)(p||(p=Object(s.a)(["\n          top: 1rem;\n        "]))):Object(f.a)(g||(g=Object(s.a)(["\n          bottom: 1rem;\n        "])))}),A=f.b.div(v||(v=Object(s.a)(["\n  display: flex;\n  flex-direction: row;\n  gap: ",";\n  margin: 0px auto;\n  place-items: center;\n  box-sizing: border-box;\n"])),function(e){var t=e.gap;return"".concat(t,"rem")}),R=function(){return o.a.createElement(I.a,{orientation:"vertical"})},_=function(e){var t=e.position,n=e.gap,a=void 0===n?.5:n,r=e.style,l=void 0===r?{}:r,c=e.children;return o.a.createElement(T,{position:t,style:l},o.a.createElement(A,{gap:a},c))},B=n(158),N=n(2),D=n(9),P=Object(f.c)(h||(h=Object(s.a)(["\n  from {\n    transform: scale(1.0);\n    opacity: 1.0;\n  }\n  to {\n    transform: scale(2.0);\n    opacity: 0.0;\n  }\n"]))),U=f.b.div(k||(k=Object(s.a)(["\n  position: absolute;\n  display: flex;\n  width: 1em;\n  height: 1em;\n  background: ",";\n  border-radius: 8rem;\n  align-items: center;\n  justify-content: center;\n  scale: ",";\n\n  ",";\n\n  > .icon {\n    display: flex;\n    justify-content: center;\n    align-items: center;\n  }\n"])),function(e){return e.color},function(e){return e.size},function(e){return e.animate&&Object(f.a)(j||(j=Object(s.a)(["\n      animation: "," 1s ease-in-out infinite;\n    "])),P)}),J=f.b.div(O||(O=Object(s.a)(["\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  flex-direction: column;\n"]))),W=function(e){var t=e.color,n=void 0===t?"dodgerblue":t,a=e.size,r=void 0===a?2:a,l=e.children;return o.a.createElement(J,null,o.a.createElement(U,{color:n,size:r,animate:!0}),o.a.createElement(U,{color:n,size:r},o.a.createElement("div",{className:"icon"},l)))},V=n(75),q=n.n(V),Z=n(71),G=n.n(Z),K=f.b.div(E||(E=Object(s.a)(["\n  position: absolute;\n  top: 0;\n  left: 0;\n  width: 100%;\n  max-width: 280px;\n  height: 100%;\n  display: flex;\n  align-items: center;\n  justify-items: center;\n  transition: transform 400ms cubic-bezier(0.65, 0.05, 0.36, 1);\n  z-index: 99999;\n\n  ","\n"])),function(e){return e.fold&&Object(f.a)(y||(y=Object(s.a)(["\n      transform: translateX(-100%);\n    "])))}),X=f.b.div(x||(x=Object(s.a)(["\n  width: 100%;\n  height: 100%;\n  background-color: #ffffff;\n  border: 0;\n  border-radius: 0;\n  outline: 0;\n  margin: 0;\n  padding: 1em 2em;\n  box-sizing: border-box;\n  box-shadow: 0 0 1em rgba(128, 128, 128, 0.5);\n  overflow-y: auto;\n"]))),$=f.b.div(w||(w=Object(s.a)(["\n  position: absolute;\n  display: flex;\n  width: 1.25em;\n  height: 100%;\n  right: -1.25em;\n  justify-content: center;\n  align-items: center;\n"]))),H=f.b.div(C||(C=Object(s.a)(["\n  width: 100%;\n  height: 3em;\n  display: flex;\n  padding: 0 2px;\n  justify-content: center;\n  align-items: center;\n  box-sizing: border-box;\n  background-color: #ffffff;\n  border-top-right-radius: 5px;\n  border-bottom-right-radius: 5px;\n  clip-path: inset(-1em -1em -1em 0px);\n  box-shadow: 0 0 1em rgba(128, 128, 128, 0.5);\n  cursor: pointer;\n"]))),Q=function(e){var t=e._ref,n=e.children,a=Object(r.useState)(!0),l=Object(u.a)(a,2),c=l[0],i=l[1],s=Object(r.useCallback)(function(){var e={sx:{width:"100%",fontSize:"1rem"}};return c?o.a.createElement(G.a,e):o.a.createElement(q.a,e)},[c]);return o.a.createElement(K,{fold:c},o.a.createElement(X,{ref:t},o.a.createElement(o.a.Fragment,null,n)),o.a.createElement($,null,o.a.createElement(H,{onClick:function(e){i(function(e){return!e})}},o.a.createElement(s,null))))},Y=o.a.forwardRef(function(e,t){return o.a.createElement(Q,{_ref:t},o.a.createElement(o.a.Fragment,null,e.children))}),ee=n(45),te=n.n(ee),ne=n(80),ae=n.n(ne),re=n(81),oe=n.n(re),le=n(157),ce=n(152),ie={currentTime:null,logs:[]},ue=Object(r.createContext)(void 0),se=function(e){var t=Object(r.useState)(ie),n=Object(u.a)(t,2),a=n[0],l=n[1];return o.a.createElement(ue.Provider,{value:{state:Object(i.a)({},a),setState:l}},o.a.createElement(o.a.Fragment,null,e.children))},de=n(150),fe=n(149),me=n(151),be=n(44),pe=n.n(be),ge=n(79),ve=n.n(ge),he=n(78),ke=n.n(he),je=n(155),Oe=n(154),Ee=n(156),ye=function(e){var t=e.tooltip,n=void 0===t?void 0:t,a=e.tooltipColor,r=void 0===a?"primary":a,l=e.tooltipPlacement,c=void 0===l?"bottom":l,i=e.tooltipSize,u=void 0===i?"sm":i,s=e.active,d=e.disabled,f=void 0!==d&&d,m=e.loading,b=void 0!==m&&m,p=e.variant,g=void 0===p?"plain":p,v=e.size,h=e.onClick,k=e.children;return o.a.createElement(Oe.a,{arrow:!0,title:n,color:r,placement:c,size:u,variant:g},o.a.createElement(je.a,{variant:s?"solid":"soft",sx:{"--IconButton-size":v},disabled:f,onClick:h},b?o.a.createElement(Ee.a,{color:"primary",size:"sm",value:33,variant:"plain"}):k))},xe=n(77),we=n.n(xe),Ce=function(e){var t=e.title,n=e.active,a=void 0!==n&&n,r=e.disabled,l=void 0!==r&&r,c=e.loading,i=void 0!==c&&c,u=e.icon,s=e.onClick;return o.a.createElement(ye,{tooltip:t,tooltipColor:"primary",tooltipPlacement:"top",active:a,disabled:l,loading:i,variant:"outlined",size:"32px",onClick:s},u)},Se=function(e){var t=e.speed,n=e.onSelectSpeed,a=o.a.useState(null),l=Object(u.a)(a,2),c=l[0],i=l[1],s=Boolean(c),d=function(){i(null)},f=Object(r.useCallback)(function(e){return o.a.createElement(de.a,Object.assign({},t===e&&{selected:!0,variant:"soft"},{onClick:function(){return function(e){n(e),d()}(e)}}),"x",e.toFixed(1))},[t]);return o.a.createElement("div",null,o.a.createElement(Ce,{title:s?void 0:"\uc7ac\uc0dd \uc18d\ub3c4",onClick:function(e){i(e.currentTarget)},icon:o.a.createElement(we.a,null)}),o.a.createElement(fe.a,{anchorEl:c,open:s,onClose:d,color:"primary",size:"sm",variant:"plain"},f(1),f(2),f(5),f(10)))},Le=f.b.div(S||(S=Object(s.a)(["\n  width: calc(100vw - 600px);\n  width: calc(100svw - 600px);\n  max-width: 480px;\n  padding-left: 0.5rem;\n  padding-right: 1rem;\n  box-sizing: border-box;\n"]))),Me=function(e){var t=e.running,n=e.runable,a=e.progressMax,l=e.progressCurrent,c=e.speed,i=e.onSelectSpeed,u=e.onProgressUpdated,s=e.onClickPlay,d=e.onClickUpload,f=Object(r.useCallback)(function(){return t?o.a.createElement(Ce,{title:"\uc77c\uc2dc\uc815\uc9c0",onClick:s,icon:o.a.createElement(ke.a,null)}):o.a.createElement(Ce,{title:"\uc7ac\uc0dd",disabled:!n,onClick:s,icon:o.a.createElement(ve.a,null)})},[t,n]),m=Object(r.useCallback)(function(){var e=Object(r.useRef)(null);return o.a.createElement(o.a.Fragment,null,o.a.createElement("label",{htmlFor:"upload-log",style:{width:"32px"}},o.a.createElement("input",{ref:e,style:{display:"none"},id:"upload-log",name:"upload-log",type:"file",accept:".json,application/json",onChange:d}),o.a.createElement(Ce,{title:"\uc5c5\ub85c\ub4dc",icon:o.a.createElement(pe.a,null),onClick:function(){e.current&&e.current.click()}})))},[d]);return o.a.createElement(o.a.Fragment,null,o.a.createElement(_,{position:"bottom"},o.a.createElement(m,null),o.a.createElement(f,null),o.a.createElement(Se,{speed:c,onSelectSpeed:i}),o.a.createElement(R,null),o.a.createElement(Le,null,o.a.createElement(me.a,{color:"primary","aria-label":"Timestamp",defaultValue:0,value:l,min:0,max:a,step:1,disabled:!n||t,size:"md",valueLabelDisplay:"off",variant:"solid",onChange:function(e,t){console.log("new value",t),u("number"===typeof t?t:t[0])},style:{width:"calc(100% - 0.5rem)",marginLeft:"0.5rem"}}))))},ze=function(){return Fe(Ie([64*Math.random(),128*Math.random(),64*Math.random()+128].map(Math.round)))};function Fe(e){return"#"+e.map(function(e){return e.toString(16).padStart(2,"0")}).join("")}function Ie(e){for(var t=Object(D.a)(e),n=t.length-1;n>0;n--){var a=Math.floor(Math.random()*(n+1)),r=t[n];t[n]=t[a],t[a]=r}return t}var Te,Ae,Re=-1,_e=0,Be=1,Ne=2,De=function(e){var t=e.color,n=e.style,a=e.children,r=e.onClick;return o.a.createElement("div",{style:Object(i.a)({backgroundColor:t||"black",display:"flex",justifyItems:"center",alignItems:"center",width:"32px",height:"32px",borderRadius:"6rem"},n),onClick:r||null},o.a.createElement(o.a.Fragment,null,a))},Pe=f.b.div(L||(L=Object(s.a)(["\n  width: calc(100% - 12px);\n  position: relative;\n  box-sizing: border-box;\n  padding: 0 6px;\n  display: flex;\n  align-items: center;\n"]))),Ue=f.b.div(M||(M=Object(s.a)(["\n  position: absolute;\n  width: 100%;\n  height: 3px;\n  background-color: #efefef;\n  border-radius: 1em;\n  z-index: 0;\n"]))),Je=function(e){var t=e.type,n=e.style,a=void 0===n?{}:n,r=Object(i.a)({fill:"white",marginTop:"-1px",width:"75%"},a);return t==Re?o.a.createElement(o.a.Fragment,null):t==_e?o.a.createElement(te.a,{style:r}):t==Be?o.a.createElement(ae.a,{style:r}):t==Ne?o.a.createElement(oe.a,{style:r}):void 0},We=f.b.div(z||(z=Object(s.a)(["\n  display: grid;\n  grid-template-columns: auto 1fr auto;\n  padding: 0.5rem 0;\n"]))),Ve=function(e,t,n,a,r,o){var l=Math.abs(n-e),c=Math.abs(a-t),i=r-e,u=o-t,s=Math.sqrt(i*i+u*u)/Math.sqrt(l*l+c*c);return Math.max(0,Math.min(100*s,100))},qe=function(){var e=Object(r.useState)([]),t=Object(u.a)(e,2),n=t[0],a=t[1],l=function(){var e=Object(r.useContext)(ue);if(void 0===e)throw new Error("useStatusState should be used within StatusProvider");return[e.state,e.setState]}(),c=Object(u.a)(l,2),s=c[0],f=c[1],m=Object(r.useState)(3),b=Object(u.a)(m,2),p=b[0],g=b[1],v=Object(r.useState)(!1),h=Object(u.a)(v,2),k=h[0],j=h[1],O=Object(r.useState)(!1),E=Object(u.a)(O,2),y=E[0],x=E[1],w=Object(r.useState)(1),C=Object(u.a)(w,2),S=C[0],L=C[1],M=Object(r.useState)(0),z=Object(u.a)(M,2),F=z[0],T=z[1],A=Object(r.useState)(0),R=Object(u.a)(A,2),_=R[0],B=R[1],P=Object(r.useState)({}),U=Object(u.a)(P,2),J=U[0],V=U[1],q=Object(r.useState)([]),Z=Object(u.a)(q,2),G=Z[0],K=Z[1];Object(r.useEffect)(function(){var e=s.logs;j(e&&e.length>0),K(e),B(0)},[s]);var X=Object(d.e)();Object(r.useEffect)(function(){g(X.getLevel())},[X]),Object(r.useEffect)(function(){X.setLevel(p)},[X,p]);var $=Object(r.useCallback)(function(e){if(G&&!(e>=G.length)){var t=G[e],n=(t.time,t.vehicles),r=t.tasks,o=Array.from(n||[]).map(function(e){var t=e.name,n=e.lat,a=e.lng;return{key:t,color:J[t],size:5,lat:n,lng:a,type:_e}}),l=Array.from(r||[]).map(function(e){var t=e.id,n=e.pick_lat,a=e.pick_lng,r=e.drop_lat,o=e.drop_lng,l=e.status;return[0<=l&&l<=5?{key:"task-".concat(t,"-pick"),color:J[t],size:4,lat:n,lng:a,type:Be}:null,{key:"task-".concat(t,"-drop"),color:J[t],size:4,lat:r,lng:o,type:Ne}]}).flat().filter(function(e){return null!==e});a([].concat(Object(D.a)(o),Object(D.a)(l)))}},[G,J]);Object(r.useEffect)(function(){$(_)},[_]),Object(r.useEffect)(function(){if(y){var e=1e3/(S||1);console.log("info",e,y,S);var t=setTimeout(function(){B(function(e){return e+1})},e);return function(){clearTimeout(t)}}},[y,S,_]);var H=Object(r.useCallback)(function(e){if(!(e.length<1)){var t=new kakao.maps.LatLngBounds;e.forEach(function(e){var n=e.lat,a=e.lng;t.extend(new kakao.maps.LatLng(n,a))}),X.setBounds(t)}},[X]);Object(r.useEffect)(function(){if(G&&!(G.length<1)){var e=G.map(function(e){var t,n=e.vehicles,a=e.tasks;return(t=n.map(function(e){return{lat:e.lat,lng:e.lng}})).concat.apply(t,Object(D.a)(a.map(function(e){return[{lat:e.pick_lat,lng:e.pick_lng},{lat:e.drop_lat,lng:e.drop_lng}]})))}).flat();T(G.length-1),H(e),$(0)}},[G,H,$]),Object(r.useEffect)(function(){if(G&&!(G.length<1)){var e=Object(D.a)(Array.from(new Set(G.map(function(e){var t=e.vehicles,n=e.tasks;return t.map(function(e){var t=e.name;return"".concat(t)}).concat(n.map(function(e){var t=e.id;return"".concat(t)}))}).flat()))).map(function(e){return Object(N.a)({},e,ze())}).reduce(function(e,t){return Object(i.a)({},e,t)},{});V(e)}},[G]);var Q=Object(r.useCallback)(function(e){var t=e.lat,n=e.lng;X.panTo(new kakao.maps.LatLng(t,n))},[X]),ee=Object(r.useCallback)(function(e){e.time;var t=e.vehicles,n=e.tasks,a=e.colors;return o.a.createElement(o.a.Fragment,null,t.filter(function(e){return null!=e.allocated_id}).sort(function(e,t){var n="".concat(e.lat,"-").concat(t.lat),a="".concat(e.lng,"-").concat(t.lng);return n<a?-1:n===a?0:1}).map(function(e){var t=e.name,r=e.lat,l=e.lng,c=e.allocated_id,u=Array.from(n||[]).filter(function(e){return e.id===c});if(u.length<1)return null;var s=u[0],d=s.id,f=s.status,m=s.pick_lat,b=s.pick_lng,p=s.drop_lat,g=s.drop_lng,v=f>5,h=f>6,k={backgroundColor:"transparent",borderWidth:"1px",borderColor:a[d],borderStyle:"dashed"},j={borderWidth:"1px",borderColor:"transparent",borderStyle:"solid"},O={fill:a[d]};return o.a.createElement(We,{className:"pairs",key:"log-info-".concat(d)},o.a.createElement(De,{color:f<=5?"transparent":a[d],style:Object(i.a)({justifySelf:"flex-start",cursor:"pointer"},v?j:k),onClick:function(){Q({lat:m,lng:b})}},o.a.createElement(Je,{type:Be,style:Object(i.a)({margin:"0 auto"},v?{}:O)})),o.a.createElement(Pe,null,o.a.createElement(Ue,{style:v?{backgroundColor:a[d]}:{}}),o.a.createElement("div",{style:{position:"absolute",width:"calc(100% - 32px)",top:0}},o.a.createElement(De,{key:"logicon-name",color:a[t],style:{position:"absolute",left:"".concat(Ve(m,b,p,g,r,l),"%"),transition:"all 300ms ease",cursor:"pointer",zIndex:1},onClick:function(){Q({lat:r,lng:l})}},o.a.createElement(Je,{type:_e,style:{margin:"0 auto"}})))),o.a.createElement(De,{color:a[d],style:Object(i.a)({justifySelf:"flex-end",cursor:"pointer"},h?j:k),onClick:function(){Q({lat:p,lng:g})}},o.a.createElement(Je,{type:Ne,style:Object(i.a)({margin:"0 auto"},h?{}:O)})))}))},[Q]),te=Object(r.useState)([]),ne=Object(u.a)(te,2),ae=ne[0],re=ne[1];Object(r.useEffect)(function(){if(G&&!(G.length<1)){var e=G.slice(0,_+1);re(e)}},[G,_]);var oe=Object(r.useCallback)(function(){if(!ae||ae.length<1)return o.a.createElement("center",{style:{position:"absolute",top:"50%",left:0,width:"100%"}},o.a.createElement(le.a,{color:"neutral",fontSize:2,sx:{translate:"0% -50%",textAlign:"center"}},"\uc7ac\uc0dd\ud560 \uc815\ubcf4\uac00 \uc5c6\uc2b5\ub2c8\ub2e4."));var e=ae[ae.length-1],t=e.time,n=e.vehicles,a=e.tasks;return o.a.createElement(ce.a,{spacing:1},o.a.createElement("div",{key:"log-".concat(t)},o.a.createElement(I.a,{sx:{marginTop:"0.5rem",marginBottom:"0.25rem"}},o.a.createElement(le.a,{color:"neutral",fontSize:2},function(e){var t={timeZone:"Asia/Seoul"},n=new Intl.DateTimeFormat("ko-kr",Object(i.a)({dateStyle:"full"},t)).format(e),a=new Intl.DateTimeFormat("ko-kr",Object(i.a)({dayPeriod:"long"},t)).format(e),r=new Intl.DateTimeFormat("ko-kr",Object(i.a)({hour:"numeric",minute:"numeric",second:"numeric",hour12:!0},t)).format(e).split(" ")[1].split(":"),o=Object(u.a)(r,3),l=o[0],c=o[1];return o[2],[n,a,"".concat(l,"\uc2dc ").concat(c,"\ubd84")].join("\n")}(new Date(t)))),o.a.createElement(ee,{time:t,vehicles:n,tasks:a,colors:J})))},[ae,J]);return o.a.createElement(o.a.Fragment,null,n.map(function(e){var t=e.key,n=e.color,a=e.size,r=e.lat,l=e.lng,c=e.type;return o.a.createElement(d.a,{key:t,position:{lat:r,lng:l},ref:function(e){null!=e&&(e.cc.parentElement.className="vehicle-marker")}},o.a.createElement(W,{color:n||"dodgerblue",size:a/p},o.a.createElement(Je,{type:c})))}),o.a.createElement(Me,{running:y,runable:k,progressMax:F,progressCurrent:_,speed:S,onSelectSpeed:L,onProgressUpdated:B,onClickPlay:function(){return x(!y)},onClickUpload:function(e){var t=e.target.files;if(t&&!(t.length<1)){var n=t[0],a=new FileReader;a.addEventListener("load",function(e){var t=e.target.result;try{var n=JSON.parse(t).logs;f(function(e){return Object(i.a)({},e,{logs:n})}),$(0)}catch(a){window.alert("Wrong JSON file format")}}),a.readAsText(n)}}}),o.a.createElement(Y,null,o.a.createElement(oe,null)))},Ze=f.b.div(Te||(Te=Object(s.a)(["\n  position: absolute;\n  display: flex;\n  width: 0.75em;\n  height: 0.75em;\n  background: white;\n  border-width: 0.15rem;\n  border-style: solid;\n  border-color: ",";\n  border-radius: 8rem;\n  align-items: center;\n  justify-content: center;\n  scale: ",";\n  box-sizing: border-box;\n  cursor: pointer;\n\n  &:hover {\n    border-color: ",";\n  }\n"])),function(e){var t=e.selected,n=e.color;return t?"black":void 0===n?"#d3232f":n},function(e){return e.size},function(e){var t=e.selected,n=e.color;return t?"black":void 0===n?"#a10e25":n}),Ge=f.b.div(Ae||(Ae=Object(s.a)(["\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  flex-direction: column;\n"]))),Ke=function(e){var t=e.id,n=e.size,a=void 0===n?2:n,r=e.selected,l=void 0!==r&&r,c=e.color,i=e.children,u=e.onMouseEnter,s=e.onMouseDown,d=e.onMouseLeave,f=e.onMouseUp,m=e.onClick;return o.a.createElement(Ge,{"data-id":t},o.a.createElement(Ze,{size:a,color:c,selected:l,onMouseEnter:u,onMouseLeave:d,onMouseDown:s,onMouseUp:f,onClick:m},o.a.createElement("div",{className:"icon"},i)))},Xe=n(82),$e=n.n(Xe),He=n(83),Qe=n.n(He),Ye=n(84),et=n.n(Ye),tt=n(85),nt=n.n(tt),at=function(e){var t=e.title,n=e.active,a=void 0!==n&&n,r=e.icon,l=e.onClick;return o.a.createElement(ye,{tooltip:t,tooltipColor:"primary",tooltipPlacement:"top",active:a,variant:"outlined",size:"32px",onClick:l},r)},rt=function(e){var t=e.editMode,n=e.onModeChanged,a=e.onClickUpload,l=e.onClickDownload,c=function(e){n(e)},i=Object(r.useCallback)(function(){return o.a.createElement(o.a.Fragment,null,o.a.createElement(at,{title:"\uc810 \ucd94\uac00/\uc0ad\uc81c",active:"add"===t,icon:o.a.createElement($e.a,null),onClick:function(){return c("add")}}),o.a.createElement(at,{title:"\uc810 \uc5f0\uacb0",active:"link"===t,icon:o.a.createElement(Qe.a,null),onClick:function(){return c("link")}}),o.a.createElement(at,{title:"\uc810 \uc774\ub3d9",active:"move"===t,icon:o.a.createElement(et.a,null),onClick:function(){return c("move")}}))},[t]),u=Object(r.useCallback)(function(){var e=Object(r.useRef)(null);return o.a.createElement(o.a.Fragment,null,o.a.createElement("label",{htmlFor:"upload-log",style:{width:"100%"}},o.a.createElement("input",{ref:e,style:{display:"none"},id:"upload-log",name:"upload-log",type:"file",accept:".json,application/json",onChange:a}),o.a.createElement(at,{title:"\uc5c5\ub85c\ub4dc",icon:o.a.createElement(pe.a,null),onClick:function(){e.current&&e.current.click()}})))},[a]),s=Object(r.useCallback)(function(){return o.a.createElement(at,{title:"\ub2e4\uc6b4\ub85c\ub4dc",icon:o.a.createElement(nt.a,null),onClick:l})},[l]);return o.a.createElement(o.a.Fragment,null,o.a.createElement(_,{position:"bottom"},o.a.createElement(i,null),o.a.createElement(R,null),o.a.createElement(u,null),o.a.createElement(s,null)))},ot=n(86),lt=n(87),ct=function(){function e(t){Object(ot.a)(this,e),this.nodes=void 0,this.parentIdx=void 0,this.nodes=t,this.parentIdx=new Map}return Object(lt.a)(e,[{key:"hasKey",value:function(e){return e in this.parentIdx}},{key:"find",value:function(e){var t=this.parentIdx.get(e);if(t&&e!==t){var n=this.find(t);return this.parentIdx.set(e,n),n}return this.parentIdx.set(e,e),e}},{key:"merge",value:function(e,t){var n=this.find(e),a=this.find(t);this.parentIdx.set(n,a)}},{key:"keys",value:function(){return Array.from(this.parentIdx.keys())}}]),e}();function it(e,t){var n="undefined"!==typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"===typeof e)return ut(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return ut(e,t)}(e))||t&&e&&"number"===typeof e.length){n&&(e=n);var a=0,r=function(){};return{s:r,n:function(){return a>=e.length?{done:!0}:{done:!1,value:e[a++]}},e:function(e){throw e},f:r}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,l=!0,c=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return l=e.done,e},e:function(e){c=!0,o=e},f:function(){try{l||null==n.return||n.return()}finally{if(c)throw o}}}}function ut(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,a=new Array(t);n<t;n++)a[n]=e[n];return a}var st=function(e,t){var n,a=e.map(function(e){return e.key}),r=function(e){return a.indexOf(e)},o={nodes:e.map(function(e){var t=e.key,n=e.lat,a=e.lng;return{id:r(t),lat:n,lng:a,info:{}}}),edges:t.map(function(e){var t=e.from,n=e.to;return{from:r(t),to:r(n)}})};!function(e,t){var n=document.createElement("a");n.download=e,n.href=URL.createObjectURL(t),n.dataset.downloadurl=["text/json",n.download,n.href].join(":"),n.addEventListener("click",function(e){setTimeout(function(){return URL.revokeObjectURL(n.href)},3e4)}),n.click()}("graph-"+(new Date).toISOString()+".json",(n=o,new Blob([JSON.stringify(n,null,2)],{type:"application/json"})))},dt=function(){var e=Object(d.e)(),t=Object(r.useState)([]),n=Object(u.a)(t,2),a=n[0],l=n[1],c=Object(r.useState)([]),s=Object(u.a)(c,2),f=s[0],m=s[1],b=Object(r.useState)([]),p=Object(u.a)(b,2),g=p[0],v=p[1],h=Object(r.useState)(1),k=Object(u.a)(h,2),j=(k[0],k[1]),O=Object(r.useState)("add"),E=Object(u.a)(O,2),y=E[0],x=E[1],w=Object(r.useState)([]),C=Object(u.a)(w,2),S=C[0],L=C[1],M=Object(r.useState)(),z=Object(u.a)(M,2),F=z[0],I=z[1],T=Object(r.useState)([]),A=Object(u.a)(T,2),R=A[0],_=A[1],B=Object(r.useState)(new Map),N=Object(u.a)(B,2),P=N[0],U=N[1],J=Object(r.useMemo)(function(){return console.log("_visibleEdges",R),R.map(function(e){return e.from,e.to,e})},[R]);Object(r.useEffect)(function(){var e=g.filter(function(e){var t,n=e.from,a=e.to,r=it(f);try{for(r.s();!(t=r.n()).done;){var o=t.value.key;if(n===o||a===o)return!0}}catch(l){r.e(l)}finally{r.f()}return!1});_(e)},[f,g]),Object(r.useEffect)(function(){var e,t=new ct(a),n=it(g);try{for(n.s();!(e=n.n()).done;){var r=e.value;t.merge(r.from,r.to)}}catch(h){n.e(h)}finally{n.f()}var o,l=new Map,c=new Map,i=it(t.keys());try{for(i.s();!(o=i.n()).done;){var u=o.value;c.set(u,ze())}}catch(h){i.e(h)}finally{i.f()}var s,d=it(g);try{for(d.s();!(s=d.n()).done;){var f=s.value,m=f.from,b=f.to,p=t.find(m),v=t.find(b);l.set(m,c.get(p)),l.set(b,c.get(v))}}catch(h){d.e(h)}finally{d.f()}console.log("set graph colors",l),U(l)},[a,g]);var W=Object(r.useCallback)(function(){var t=e.getBounds(),n=e.getLevel(),a=[t.getNorthEast(),t.getSouthWest()],r=a[0],o=a[1],l=o.getLat(),c=o.getLng(),i=r.getLat(),u=r.getLng();return{level:n,top:l,left:c,bottom:i,right:u,width:u-c,height:i-l}},[e]),V=Object(r.useCallback)(function(e){var t=W(),n=t.top,a=t.left,r=t.bottom,o=t.right,l=t.width,c=t.height,i=t.level,u=e.filter(function(e){var t=e.lat,l=e.lng;return n<=t&&t<=r&&a<=l&&l<=o}).map(function(e){var t=e.key,n=e.lat,a=e.lng;return{id:t,key:t,lat:n,lng:a,grid:"".concat(Math.round(n/(l/100)),",").concat(Math.round(a/(c/100)))}}),s=Object(D.a)(Array.from(new Map(u.map(function(e){var t=e.key;return[e.grid,{id:t,key:t,lat:e.lat,lng:e.lng}]})).values()));console.log("Bounds:",n,a,r,o),console.log("Nodes(Grid)",u,s),console.log("Bounds (width, height)",r-n,o-a,i),console.log("Set New Temporal Nodes",s),m(s)},[W]),q=Object(r.useCallback)(function(e){return-1!==S.indexOf(e)},[S]),Z=Object(r.useMemo)(function(){var e=a.filter(function(e){var t=e.key;return q(t)});return e.length>0?e[0]:null},[a,q]),G=function(e,t){var n,a=it(t);try{for(a.s();!(n=a.n()).done;){var r=n.value;if(r.key===e)return r}}catch(o){a.e(o)}finally{a.f()}return null},K=Object(r.useCallback)(function(e){return G(e,a)},[a]),X=Object(r.useCallback)(function(e){var t=null!==G(e,f);return console.log("isNodeVisible",e,t),t},[f]);Object(r.useEffect)(function(){j(e.getLevel()),setTimeout(function(){e.relayout()},0)},[e]),Object(r.useEffect)(function(){var e=function(e){return null!==K(e)};v(function(t){return t.filter(function(t){var n=t.from,a=t.to;return e(n)&&e(a)})})},[K,v]),Object(r.useEffect)(function(){if(console.log("selected",S),S.length>=2){var e=Object(u.a)(S,2),t=e[0],n=e[1],a=[K(t),K(n)],r=a[0],o=a[1];null!==r&&null!==o&&(function(e,t){v(function(n){return n.filter(function(n){return!(n.from==e.key&&n.to==t.key)}).concat({from:e.key,to:t.key})})}(r,o),I(void 0),L([]))}},[S,K,I]);var $=Object(r.useCallback)(function(e){var t=e.latLng;if("add"===y){var n=t.getLat(),a=t.getLng();console.log("Map Clicked",n,a),l(function(e){var t=Math.random().toString(16).slice(2),r={key:"node-".concat(t),lat:n,lng:a};return console.log("add node",r),[].concat(Object(D.a)(e),[r])})}},[y]),H=Object(r.useCallback)(function(e){},[]),Q=Object(r.useCallback)(function(e){var t=e.latLng,n=t.getLat(),a=t.getLng();if("link"===y)I({key:"cursor",lat:n,lng:a});else if("move"===y){if(1!=S.length)return;l(function(e){return e.map(function(e){return S[0]!==e.key?e:Object(i.a)({},e,{lat:n,lng:a})})})}},[y,l,S,I]);Object(r.useEffect)(function(){var t=function(){return V(a)};return kakao.maps.event.addListener(e,"idle",t),function(){kakao.maps.event.addListener(e,"idle",t)}},[e,a]),Object(r.useEffect)(function(){V(a)},[a]),Object(r.useEffect)(function(){return e.setCursor("default"),kakao.maps.event.addListener(e,"click",$),kakao.maps.event.addListener(e,"mouseup",H),kakao.maps.event.addListener(e,"mousemove",Q),function(){e.setCursor(""),kakao.maps.event.removeListener(e,"click",$),kakao.maps.event.removeListener(e,"mouseup",H),kakao.maps.event.removeListener(e,"mousemove",Q)}},[e,$,H,Q]);var Y=Object(r.useCallback)(function(e){var t=e.target.closest("[data-id]");if(t){var n=t.getAttribute("data-id")||"",a=e.button;"add"===y?2===a&&l(function(e){return Object(D.a)(e).filter(function(e){return e.key!==n})}):"link"===y?0===a?L(function(e){return e.filter(function(e){return e!=n}).concat(n)}):2===a&&L(function(e){return e.filter(function(e){return e!=n})}):"move"===y&&0===a&&L(function(e){return e.length>0?[]:[n]})}},[y,l,L]),ee=Object(r.useCallback)(function(e){},[]),te=Object(r.useMemo)(function(){return o.a.createElement(o.a.Fragment,null,"link"===y&&Z&&F&&o.a.createElement(d.c,{key:"edge-guide",path:[Z,F].map(function(e){return{lat:e.lat,lng:e.lng}}),strokeWeight:3,strokeColor:"#db4040",strokeOpacity:1,strokeStyle:"dashed"}))},[y,Z,F]),ne=Object(r.useCallback)(function(){var e=W().level;return o.a.createElement(o.a.Fragment,null,f.map(function(t){var n=t.key,a=t.lat,r=t.lng;return o.a.createElement(d.a,{position:{lat:a,lng:r},key:n},o.a.createElement(Ke,{id:n,color:P.get(n),size:6/e,selected:q(n),onMouseDown:Y,onMouseUp:ee}))}))},[f,P,W,q,Y,ee]),ae=Object(r.useCallback)(function(){return console.log("graph colors",P),o.a.createElement(o.a.Fragment,null,J.map(function(e){var t=e.from,n=e.to,a=[t,n].map(K).filter(function(e){return null!==e});return 2!=a.length?o.a.createElement(o.a.Fragment,null):o.a.createElement(d.c,{key:"edge-".concat(t,"-").concat(n),path:a.map(function(e){return{lat:e.lat,lng:e.lng}}),strokeWeight:3,strokeColor:P.get(t),strokeOpacity:1,strokeStyle:"solid"})}))},[J,P,K,X]),re=Object(r.useCallback)(function(t){if(!(t.length<1)){var n=new kakao.maps.LatLngBounds;t.forEach(function(e){var t=e.lat,a=e.lng;n.extend(new kakao.maps.LatLng(t,a))}),e.setBounds(n),setTimeout(function(){e.relayout()},0)}},[e]),oe=Object(r.useCallback)(function(e){var t=e.target.files;if(t&&!(t.length<1)){var n=t[0],a=new FileReader;a.addEventListener("load",function(e){var t=e.target.result;try{var n=JSON.parse(t),a=n.nodes,r=n.edges,o=a.map(function(e){var t=e.id,n=e.lat,a=e.lng;return{key:"node-".concat(t),lat:n,lng:a}});l(o),v(r.map(function(e){var t=e.from,n=e.to;return{from:o[t].key,to:o[n].key}})),re(a)}catch(c){window.alert("Failed to parse JSON")}}),a.readAsText(n)}},[l,v]),le=Object(r.useCallback)(function(){return st(a,g)},[a,g]);return o.a.createElement(o.a.Fragment,null,o.a.createElement(ae,null),te,o.a.createElement(ne,null),o.a.createElement(rt,{editMode:y||"add",onClickDownload:le,onClickUpload:oe,onModeChanged:x}))},ft=n(88),mt=n.n(ft),bt={mode:"view",viewSpeed:1,viewRunning:!1},pt=Object(r.createContext)(void 0),gt=function(e){var t=Object(r.useState)(bt),n=Object(u.a)(t,2),a=n[0],l=n[1];return o.a.createElement(pt.Provider,{value:{state:Object(i.a)({},a),setState:l}},o.a.createElement(o.a.Fragment,null,e.children))},vt=function(){var e=Object(r.useContext)(pt);if(void 0===e)throw new Error("useControlState should be used within ControlProvider");return[e.state,e.setState]},ht=(n(109),function(e){var t=e.mode,n=e.onChange;return o.a.createElement(o.a.Fragment,null,o.a.createElement(B.a,{size:"sm",startDecorator:o.a.createElement(te.a,null),variant:"view"===t?"solid":"plain",onClick:function(){return n("view")},sx:{borderTopRightRadius:0,borderBottomRightRadius:0}},"Viewer"),o.a.createElement(B.a,{size:"sm",startDecorator:o.a.createElement(mt.a,null),variant:"edit"===t?"solid":"plain",onClick:function(){return n("edit")},sx:{borderTopLeftRadius:0,borderBottomLeftRadius:0}},"Editor"))});function kt(){var e=vt(),t=Object(u.a)(e,2),n=t[0],a=t[1],l=Object(r.useState)(3),c=Object(u.a)(l,2),s=c[0],d=c[1],f=Object(r.useCallback)(function(){return o.a.createElement(_,{position:"top",gap:0,style:{padding:0,height:"auto"}},o.a.createElement(ht,{mode:n.mode,onChange:function(e){a(function(t){return Object(i.a)({},t,{mode:e})})}}))},[n.mode,a]);return o.a.createElement(o.a.Fragment,null,o.a.createElement(F,{center:{lat:37.52897,lng:126.917101},level:s,onZoomChanged:function(e){return d(e.getLevel())},style:{width:"100%",height:"100vh",zIndex:0}},o.a.createElement(f,null),"view"==n.mode?o.a.createElement(qe,null):o.a.createElement(dt,null)))}var jt=function(){return o.a.createElement("div",{className:"App"},o.a.createElement(se,null,o.a.createElement(gt,null,o.a.createElement(kt,null))))},Ot=function(e){e&&e instanceof Function&&n.e(3).then(n.bind(null,160)).then(function(t){var n=t.getCLS,a=t.getFID,r=t.getFCP,o=t.getLCP,l=t.getTTFB;n(e),a(e),r(e),o(e),l(e)})};c.a.createRoot(document.getElementById("root")).render(o.a.createElement(jt,null)),Ot()},99:function(e,t,n){e.exports=n(111)}},[[99,1,2]]]);
//# sourceMappingURL=main.37a8f74d.chunk.js.map